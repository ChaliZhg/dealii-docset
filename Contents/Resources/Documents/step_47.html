<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-47 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2017 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The step-47 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;deal.II/base/quadrature_lib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/function.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/logstream.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/vector.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/full_matrix.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/sparse_matrix.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/dynamic_sparsity_pattern.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/solver_cg.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/precondition.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_handler.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_generator.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria_accessor.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria_iterator.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/manifold_lib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_accessor.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_q.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_nothing.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_system.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_values.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/vector_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/matrix_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/data_out.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_q.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_out.h&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/constraint_matrix.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_refinement.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/error_estimator.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span>Step47</div><div class="line">{</div><div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">double</span> sign (<span class="keywordtype">double</span> d)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (d &gt; 0)</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d &lt; 0)</div><div class="line">      <span class="keywordflow">return</span> -1;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keyword">class </span>LaplaceProblem</div><div class="line">  {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    LaplaceProblem ();</div><div class="line">    ~LaplaceProblem ();</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> run ();</div><div class="line"></div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="keywordtype">bool</span> interface_intersects_cell (<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a> &amp;cell) <span class="keyword">const</span>;</div><div class="line">    std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt; compute_quadrature(<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature, <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;level_set_values);</div><div class="line">    <span class="keywordtype">void</span> append_quadrature(<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                           <span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;v      ,</div><div class="line">                           std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;xfem_points,</div><div class="line">                           std::vector&lt;double&gt;      &amp;xfem_weights);</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> setup_system ();</div><div class="line">    <span class="keywordtype">void</span> assemble_system ();</div><div class="line">    <span class="keywordtype">void</span> solve ();</div><div class="line">    <span class="keywordtype">void</span> refine_grid ();</div><div class="line">    <span class="keywordtype">void</span> output_results (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle) <span class="keyword">const</span>;</div><div class="line">    <span class="keywordtype">void</span> compute_error () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a>    triangulation;</div><div class="line"></div><div class="line">    <a class="code" href="classhp_1_1DoFHandler.html">hp::DoFHandler&lt;dim&gt;</a>   dof_handler;</div><div class="line">    <a class="code" href="classhp_1_1FECollection.html">hp::FECollection&lt;dim&gt;</a> fe_collection;</div><div class="line"></div><div class="line">    <a class="code" href="classConstraintMatrix.html">ConstraintMatrix</a>      constraints;</div><div class="line"></div><div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a>       sparsity_pattern;</div><div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a>  system_matrix;</div><div class="line"></div><div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>        solution;</div><div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>        system_rhs;</div><div class="line">  };</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keyword">class </span>Coefficient : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line">  {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Coefficient () : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;() {}</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> value (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>   &amp;p,</div><div class="line">                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  component = 0) <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> value_list (<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;points,</div><div class="line">                             std::vector&lt;double&gt;            &amp;values,</div><div class="line">                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              component = 0) <span class="keyword">const</span>;</div><div class="line">  };</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span> Coefficient&lt;dim&gt;::value (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line">                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">if</span> (p.<a class="code" href="classPoint.html#a859ea7f3bf3e64be2e0f5ed1bfcc8550">square</a>() &lt; 0.5*0.5)</div><div class="line">      <span class="keywordflow">return</span> 20;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> Coefficient&lt;dim&gt;::value_list (<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;points,</div><div class="line">                                     std::vector&lt;double&gt;            &amp;values,</div><div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              component)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_points = points.size();</div><div class="line"></div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (values.size() == n_points,</div><div class="line">            <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a> (values.size(), n_points));</div><div class="line"></div><div class="line">    (void) component;</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_points; ++i)</div><div class="line">      {</div><div class="line">        <span class="keywordflow">if</span> (points[i].square() &lt; 0.5*0.5)</div><div class="line">          values[i] = 20;</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          values[i] = 1;</div><div class="line">      }</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span> exact_solution (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> r = p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> (r &lt; 0.5</div><div class="line">            ?</div><div class="line">            1./20 * (-1./4*r*r + 61./16)</div><div class="line">            :</div><div class="line">            1./4 * (1-r*r));</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  LaplaceProblem&lt;dim&gt;::LaplaceProblem ()</div><div class="line">    :</div><div class="line">    dof_handler (triangulation)</div><div class="line">  {</div><div class="line">    fe_collection.<a class="code" href="classhp_1_1FECollection.html#a4b0e75a805ff012e76d33ad6d4c3eac8">push_back</a> (<a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a> (<a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1,</div><div class="line">                                            <a class="code" href="classFE__Nothing.html">FE_Nothing&lt;dim&gt;</a>(), 1));</div><div class="line">    fe_collection.<a class="code" href="classhp_1_1FECollection.html#a4b0e75a805ff012e76d33ad6d4c3eac8">push_back</a> (<a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a> (<a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1,</div><div class="line">                                            <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1));</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  LaplaceProblem&lt;dim&gt;::~LaplaceProblem ()</div><div class="line">  {</div><div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#ad316958f8045d9a48094335b23a03a53">clear</a> ();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span></div><div class="line">  level_set (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>() - 0.5;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1,dim&gt;</a></div><div class="line">  grad_level_set (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> p / p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">bool</span></div><div class="line">  LaplaceProblem&lt;dim&gt;::</div><div class="line">  interface_intersects_cell (<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a> &amp;cell)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell-1; ++v)</div><div class="line">      <span class="keywordflow">if</span> (level_set(cell-&gt;vertex(v)) * level_set(cell-&gt;vertex(v+1)) &lt; 0)</div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div></div><!-- fragment --><p>we get here only if all vertices have the same sign, which means that the cell is not intersected</p>
<div class="fragment"><div class="line">  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::setup_system ()</div><div class="line">{</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code" href="group__Iterators.html#ga60277a8a3957ba4b41c1e76a87decd30">hp::DoFHandler&lt;dim&gt;::cell_iterator</a> cell</div><div class="line">       = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>();</div><div class="line">       cell != dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>(); ++cell)</div><div class="line">    <span class="keywordflow">if</span> (interface_intersects_cell(cell) == <span class="keyword">false</span>)</div><div class="line">      cell-&gt;set_active_fe_index(0);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      cell-&gt;set_active_fe_index(1);</div><div class="line"></div><div class="line">  dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a> (fe_collection);</div><div class="line"></div><div class="line">  solution.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line">  system_rhs.<a class="code" href="classBlockVector.html#adf4d1d6c3538af95309a95da2ded758c">reinit</a> (dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line"></div><div class="line"></div><div class="line">  constraints.clear ();</div></div><!-- fragment --><p>TODO: fix this, it currently crashes <a class="el" href="group__constraints.html#ga3eaa31a679484e80c193e74e8a967dc8">DoFTools::make_hanging_node_constraints</a> (dof_handler, constraints);</p>
<p>TODO: component 1 must satisfy zero boundary conditions</p>
<div class="fragment"><div class="line">  constraints.close();</div><div class="line"></div><div class="line"></div><div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line">  <a class="code" href="group__constraints.html#ga38d88a1a559e9fc65d60f3e168921ba5">DoFTools::make_sparsity_pattern</a> (dof_handler, dsp);</div><div class="line"></div><div class="line">  constraints.condense (dsp);</div><div class="line"></div><div class="line">  sparsity_pattern.<a class="code" href="classBlockSparsityPattern.html#a923288e4b4093f86b680e7045e9b4984">copy_from</a>(dsp);</div><div class="line"></div><div class="line">  system_matrix.reinit (sparsity_pattern);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::assemble_system ()</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>  quadrature_formula(3);</div><div class="line"></div><div class="line"></div><div class="line">  <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> plain_fe_values (fe_collection[0], quadrature_formula,</div><div class="line">                                 <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>    |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line">                                 <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>  |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = quadrature_formula.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line">  <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a>   cell_matrix;</div><div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a>       cell_rhs;</div><div class="line"></div><div class="line">  std::vector&lt;types::global_dof_index&gt; local_dof_indices;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> Coefficient&lt;dim&gt; coefficient;</div><div class="line">  std::vector&lt;double&gt;    coefficient_values (n_q_points);</div><div class="line"></div><div class="line">  <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a></div><div class="line">  cell = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>(),</div><div class="line">  endc = dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>();</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span> (; cell!=endc; ++cell)</div><div class="line">    {</div><div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().dofs_per_cell;</div><div class="line">      cell_matrix.<a class="code" href="classTableBase.html#a302ef67031a523602fd39911b968d6ab">reinit</a> (dofs_per_cell, dofs_per_cell);</div><div class="line">      cell_rhs.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (dofs_per_cell);</div><div class="line"></div><div class="line">      cell_matrix = 0;</div><div class="line">      cell_rhs = 0;</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (cell-&gt;active_fe_index() == 0)</div><div class="line">        {</div><div class="line">          plain_fe_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (cell);</div><div class="line"></div><div class="line">          coefficient_values.resize (plain_fe_values.n_quadrature_points);</div><div class="line">          coefficient.value_list (plain_fe_values.get_quadrature_points(),</div><div class="line">                                  coefficient_values);</div><div class="line"></div><div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point=0; q_point&lt;n_q_points; ++q_point)</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dofs_per_cell; ++i)</div><div class="line">              {</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                  cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                       plain_fe_values.shape_grad(i,q_point) *</div><div class="line">                                       plain_fe_values.shape_grad(j,q_point) *</div><div class="line">                                       plain_fe_values.JxW(q_point));</div><div class="line"></div><div class="line"></div><div class="line">                cell_rhs(i) += (plain_fe_values.shape_value(i,q_point) *</div><div class="line">                                1.0 *</div><div class="line">                                plain_fe_values.JxW(q_point));</div><div class="line">              }</div><div class="line">        }</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">        {</div></div><!-- fragment --><p>TODO: verify that the order of support points equals the order of vertices of the cells, as we use below</p>
<div class="fragment"><div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (cell-&gt;active_fe_index() == 1, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (interface_intersects_cell(cell) == <span class="keyword">true</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"></div><div class="line">          std::vector&lt;double&gt; level_set_values (<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div><div class="line">            level_set_values[v] = level_set (cell-&gt;vertex(v));</div><div class="line"></div><div class="line">          <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> this_fe_values (fe_collection[1],</div><div class="line">                                        compute_quadrature(quadrature_formula, cell,</div><div class="line">                                                           level_set_values).second,</div><div class="line">                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>    |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line">                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>  |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> );</div><div class="line"></div><div class="line">          this_fe_values.reinit (cell);</div><div class="line"></div><div class="line">          coefficient_values.resize (this_fe_values.n_quadrature_points);</div><div class="line">          coefficient.value_list (this_fe_values.get_quadrature_points(),</div><div class="line">                                  coefficient_values);</div><div class="line"></div><div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point=0; q_point&lt;this_fe_values.n_quadrature_points; ++q_point)</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dofs_per_cell; ++i)</div><div class="line">              <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).first == 0)</div><div class="line">                {</div><div class="line">                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                    <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).first == 0)</div><div class="line">                      cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                           this_fe_values.shape_grad(i,q_point) *</div><div class="line">                                           this_fe_values.shape_grad(j,q_point) *</div><div class="line">                                           this_fe_values.JxW(q_point));</div><div class="line">                    <span class="keywordflow">else</span></div><div class="line">                      cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                           this_fe_values.shape_grad(i,q_point)</div><div class="line">                                           *</div><div class="line">                                           ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                             -</div><div class="line">                                             std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).second))))*</div><div class="line">                                            this_fe_values.shape_grad(j,q_point)</div><div class="line">                                            +</div><div class="line">                                            grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                            sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                            this_fe_values.shape_value(j,q_point)) *</div><div class="line">                                           this_fe_values.JxW(q_point));</div><div class="line"></div><div class="line">                  cell_rhs(i) += (this_fe_values.shape_value(i,q_point) *</div><div class="line">                                  1.0 *</div><div class="line">                                  this_fe_values.JxW(q_point));</div><div class="line">                }</div><div class="line">              <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                    <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).first == 0)</div><div class="line">                      cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                           ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                             -</div><div class="line">                                             std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                            this_fe_values.shape_grad(i,q_point)</div><div class="line">                                            +</div><div class="line">                                            grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                            sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                            this_fe_values.shape_value(i,q_point)) *</div><div class="line">                                           this_fe_values.shape_grad(j,q_point) *</div><div class="line">                                           this_fe_values.JxW(q_point));</div><div class="line">                    <span class="keywordflow">else</span></div><div class="line">                      cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                           ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                             -</div><div class="line">                                             std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                            this_fe_values.shape_grad(i,q_point)</div><div class="line">                                            +</div><div class="line">                                            grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                            sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                            this_fe_values.shape_value(i,q_point)) *</div><div class="line">                                           ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                             -</div><div class="line">                                             std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).second))))*</div><div class="line">                                            this_fe_values.shape_grad(j,q_point)</div><div class="line">                                            +</div><div class="line">                                            grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                            sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                            this_fe_values.shape_value(j,q_point)) *</div><div class="line">                                           this_fe_values.JxW(q_point));</div><div class="line"></div><div class="line">                  cell_rhs(i) += ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                   -</div><div class="line">                                   std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                  this_fe_values.shape_value(i,q_point) *</div><div class="line">                                  1.0 *</div><div class="line">                                  this_fe_values.JxW(q_point));</div><div class="line">                }</div><div class="line">        }</div><div class="line"></div><div class="line">      local_dof_indices.resize (dofs_per_cell);</div><div class="line">      cell-&gt;get_dof_indices (local_dof_indices);</div><div class="line">      constraints.distribute_local_to_global (cell_matrix, cell_rhs,</div><div class="line">                                              local_dof_indices,</div><div class="line">                                              system_matrix, system_rhs);</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">  std::map&lt;types::global_dof_index,double&gt; boundary_values;</div><div class="line">  <a class="code" href="namespaceVectorTools.html#a187aeb575be07bc47cb3dea1a47aaf88">VectorTools::interpolate_boundary_values</a> (dof_handler,</div><div class="line">                                            0,</div><div class="line">                                            <a class="code" href="classZeroFunction.html">ZeroFunction&lt;dim&gt;</a>(2),</div><div class="line">                                            boundary_values);</div><div class="line">  <a class="code" href="namespaceMatrixTools.html#a9ad0eb7a8662628534586716748d62fb">MatrixTools::apply_boundary_values</a> (boundary_values,</div><div class="line">                                      system_matrix,</div><div class="line">                                      solution,</div><div class="line">                                      system_rhs);</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p>To integrate the enriched elements we have to find the geometrical decomposition of the original element in subelements. The subelements are used to integrate the elements on both sides of the discontinuity. The discontinuity line is approximated by a piece-wise linear interpolation between the intersection of the discontinuity with the edges of the elements. The vector level_set_values has the values of the level set function at the vertices of the elements. From these values can be found by linear interpolation the intersections. There are three kind of decomposition that are considered. Type 1: there is not cut. Type 2: a corner of the element is cut. Type 3: two corners are cut.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;</div><div class="line">LaplaceProblem&lt;dim&gt;::compute_quadrature (<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                                         <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;/ *cell* /,</div><div class="line">                                         <span class="keyword">const</span> std::vector&lt;double&gt; &amp;level_set_values)</div><div class="line">{</div><div class="line"></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> type = 0;</div></div><!-- fragment --><p>find the type of cut</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> sign_ls[<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>];</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (level_set_values[v] &gt; 0) sign_ls[v] = 1;</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (level_set_values[v] &lt; 0) sign_ls[v] = -1;</div><div class="line">    <span class="keywordflow">else</span> sign_ls[v] = 0;</div><div class="line">  }</div></div><!-- fragment --><p>the sign of the level set function at the 4 nodes of the elements can be positive + or negative - depending on the sign of the level set function we have the following three classes of decomposition type 1: ++++, -&mdash; type 2: -+++, +-++, ++-+, +++-, +&mdash;, -+&ndash;, &ndash;+-, &mdash;+ type 3: +&ndash;+, ++&ndash;, +-+-, -++-, &ndash;++, -+-+</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[1] &amp;&amp;</div><div class="line">     sign_ls[0]==sign_ls[2] &amp;&amp;</div><div class="line">     sign_ls[0]==sign_ls[3] )</div><div class="line">  type = 1;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]*sign_ls[1]*sign_ls[2]*sign_ls[3] &lt; 0 )</div><div class="line">  type = 2;</div><div class="line"><span class="keywordflow">else</span></div><div class="line">  type = 3;</div><div class="line"></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Pos = 100;</div><div class="line"></div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v0(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v1(1,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v2(0,1);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v3(1,1);</div><div class="line"></div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> A(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> B(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> D(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0,0);</div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> F(0,0);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (type == 1)</div><div class="line">  <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(1, plain_quadrature);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (type==2)</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div></div><!-- fragment --><p>loop over all subelements for integration in type 2 there are 5 subelements</p>
<div class="fragment"><div class="line"><a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> xfem_quadrature(5*n_q_points);</div><div class="line"></div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; v(<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (sign_ls[0]!=sign_ls[1] &amp;&amp; sign_ls[0]!=sign_ls[2] &amp;&amp; sign_ls[0]!=sign_ls[3]) Pos = 0;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[1]!=sign_ls[0] &amp;&amp; sign_ls[1]!=sign_ls[2] &amp;&amp; sign_ls[1]!=sign_ls[3]) Pos = 1;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[2]!=sign_ls[0] &amp;&amp; sign_ls[2]!=sign_ls[1] &amp;&amp; sign_ls[2]!=sign_ls[3]) Pos = 2;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[3]!=sign_ls[0] &amp;&amp; sign_ls[3]!=sign_ls[1] &amp;&amp; sign_ls[3]!=sign_ls[2]) Pos = 3;</div><div class="line"><span class="keywordflow">else</span> assert(0); <span class="comment">// error message</span></div></div><!-- fragment --><p>Find cut coordinates</p>
<p>deal.ii local coordinates</p>
<p>2----&mdash;3 | | | | | | 0----&mdash;1</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (Pos == 0)</div><div class="line">  {</div><div class="line">    A[0] = 1. - level_set_values[1]/(level_set_values[1]-level_set_values[0]);</div><div class="line">    B[1] = 1. - level_set_values[2]/(level_set_values[2]-level_set_values[0]);</div><div class="line">    A(1) = 0.;</div><div class="line">    B(0) = 0.;</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">    D(0) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">    D(1) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*A(0);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 0.;</div><div class="line">    F(0) = 0.;</div><div class="line">    F(1) = 0.5*B(1);</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 1)</div><div class="line">  {</div><div class="line">    A[0] = level_set_values[0]/(level_set_values[0]-level_set_values[1]);</div><div class="line">    B[1] = 1 - level_set_values[3]/(level_set_values[3]-level_set_values[1]);</div><div class="line">    A(1) = 0.;</div><div class="line">    B(0) = 1.;</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">    D(0) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">    D(1) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*(1 + A(0));</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 0.;</div><div class="line">    F(0) = 1.;</div><div class="line">    F(1) = 0.5*B(1);</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 2)</div><div class="line">  {</div><div class="line">    A[0] = 1 - level_set_values[3]/(level_set_values[3]-level_set_values[2]);</div><div class="line">    B[1] = level_set_values[0]/(level_set_values[0]-level_set_values[2]);</div><div class="line">    A(1) = 1.;</div><div class="line">    B(0) = 0.;</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">    D(0) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">    D(1) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5* A(0);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 1.;</div><div class="line">    F(0) = 0.;</div><div class="line">    F(1) = 0.5*( 1. + B(1) );</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 3)</div><div class="line">  {</div><div class="line">    A[0] = level_set_values[2]/(level_set_values[2]-level_set_values[3]);</div><div class="line">    B[1] = level_set_values[1]/(level_set_values[1]-level_set_values[3]);</div><div class="line">    A(1) = 1.;</div><div class="line">    B(0) = 1.;</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">    D(0) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">    D(1) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*( 1. + A(0) );</div><div class="line">    <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 1.;</div><div class="line">    F(0) = 1.;</div><div class="line">    F(1) = 0.5*( 1. + B(1) );</div><div class="line">  }</div></div><!-- fragment --><p>std::cout &lt;&lt; A &lt;&lt; std::endl; std::cout &lt;&lt; B &lt;&lt; std::endl; std::cout &lt;&lt; C &lt;&lt; std::endl; std::cout &lt;&lt; D &lt;&lt; std::endl; std::cout &lt;&lt; E &lt;&lt; std::endl; std::cout &lt;&lt; F &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">std::string filename = <span class="stringliteral">&quot;vertices.dat&quot;</span>;</div><div class="line">std::ofstream output (filename.c_str());</div><div class="line">output &lt;&lt; <span class="stringliteral">&quot;#vertices of xfem subcells&quot;</span> &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; v0(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v0(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; v1(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v1(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; v3(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v3(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; v2(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v2(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; A(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; A(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; B(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; B(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; F(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; F(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (Pos==0)</div><div class="line">  output &lt;&lt; v3(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v3(1) &lt;&lt; std::endl;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==1)</div><div class="line">  output &lt;&lt; v2(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v2(1) &lt;&lt; std::endl;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==2)</div><div class="line">  output &lt;&lt; v1(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v1(1) &lt;&lt; std::endl;</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==3)</div><div class="line">  output &lt;&lt; v0(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v0(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> subcell_vertices[10];</div><div class="line">subcell_vertices[0] = v0;</div><div class="line">subcell_vertices[1] = v1;</div><div class="line">subcell_vertices[2] = v2;</div><div class="line">subcell_vertices[3] = v3;</div><div class="line">subcell_vertices[4] = A;</div><div class="line">subcell_vertices[5] = B;</div><div class="line">subcell_vertices[6] = <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>;</div><div class="line">subcell_vertices[7] = D;</div><div class="line">subcell_vertices[8] = <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>;</div><div class="line">subcell_vertices[9] = F;</div><div class="line"></div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; xfem_points;</div><div class="line">std::vector&lt;double&gt;      xfem_weights;</div></div><!-- fragment --><p>lookup table for the decomposition</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (dim==2)</div><div class="line">  {</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell_v_indices[4][5][4] =</div><div class="line">    {</div><div class="line">      {{0,8,9,7}, {9,7,5,6}, {8,4,7,6}, {5,6,2,3}, {6,4,3,1}},</div><div class="line">      {{8,1,7,9}, {4,8,6,7}, {6,7,5,9}, {0,4,2,6}, {2,6,3,5}},</div><div class="line">      {{9,7,2,8}, {5,6,9,7}, {6,4,7,8}, {0,1,5,6}, {6,1,4,3}},</div><div class="line">      {{7,9,8,3}, {4,6,8,7}, {6,5,7,9}, {0,6,2,4}, {0,1,6,5}}</div><div class="line">    };</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell = 0; subcell&lt;5; subcell++)</div><div class="line">      {</div></div><!-- fragment --><p>std::cout &lt;&lt; "subcell : " &lt;&lt; subcell &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; vertices;</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;4; i++)</div><div class="line">  {</div><div class="line">    vertices.push_back( subcell_vertices[subcell_v_indices[Pos][subcell][i]] );</div></div><!-- fragment --><p>std::cout &lt;&lt; "i : " &lt;&lt; i &lt;&lt; std::endl; std::cout &lt;&lt; "subcell v : " &lt;&lt; subcell_v_indices[Pos][subcell][i] &lt;&lt; std::endl; std::cout &lt;&lt; vertices[i](0) &lt;&lt; " " &lt;&lt; vertices[i](1) &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">}</div></div><!-- fragment --><p>std::cout &lt;&lt; std::endl; create quadrature rule</p>
<div class="fragment"><div class="line">append_quadrature( plain_quadrature,</div><div class="line">                   vertices,</div><div class="line">                   xfem_points,</div><div class="line">                   xfem_weights);</div></div><!-- fragment --><p>initialize xfem_quadrature with quadrature points of all subelements</p>
<div class="fragment"><div class="line">          xfem_quadrature.initialize(xfem_points, xfem_weights);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (xfem_quadrature.size() == plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>() * 5, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">  <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(2, xfem_quadrature);</div><div class="line">}</div></div><!-- fragment --><p>Type three decomposition (+&ndash;+, ++&ndash;, +-+-, -++-, &ndash;++, -+-+)</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (type==3)</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div></div><!-- fragment --><p>loop over all subelements for integration in type 2 there are 5 subelements</p>
<div class="fragment"><div class="line"><a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> xfem_quadrature(5*n_q_points);</div><div class="line"></div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; v(<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[1] &amp;&amp; sign_ls[2]==sign_ls[3] )</div><div class="line">  {</div><div class="line">    Pos = 0;</div><div class="line">    A(0) = 0.;</div><div class="line">    A(1) = level_set_values[0]/((level_set_values[0]-level_set_values[2]));</div><div class="line">    B(0) = 1.;</div><div class="line">    B(1) = level_set_values[1]/((level_set_values[1]-level_set_values[3]));</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[2] &amp;&amp; sign_ls[1]==sign_ls[3] )</div><div class="line">  {</div><div class="line">    Pos = 1;</div><div class="line">    A(0) = level_set_values[0]/((level_set_values[0]-level_set_values[1]));</div><div class="line">    A(1) = 0.;</div><div class="line">    B(0) = level_set_values[2]/((level_set_values[2]-level_set_values[3]));</div><div class="line">    B(1) = 1.;</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[3] &amp;&amp; sign_ls[1]==sign_ls[2] )</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Error: the element has two cut lines and this is not allowed&quot;</span> &lt;&lt; std::endl;</div><div class="line">    assert(0);</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span></div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Error: the level set function has not the right values&quot;</span> &lt;&lt; std::endl;</div><div class="line">    assert(0);</div><div class="line">  }</div></div><!-- fragment --><p>std::cout &lt;&lt; "Pos " &lt;&lt; Pos &lt;&lt; std::endl; std::cout &lt;&lt; A &lt;&lt; std::endl; std::cout &lt;&lt; B &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">std::string filename = <span class="stringliteral">&quot;vertices.dat&quot;</span>;</div><div class="line">std::ofstream output (filename.c_str());</div><div class="line">output &lt;&lt; <span class="stringliteral">&quot;#vertices of xfem subcells&quot;</span> &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; A(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; A(1) &lt;&lt; std::endl;</div><div class="line">output &lt;&lt; B(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; B(1) &lt;&lt; std::endl;</div></div><!-- fragment --><p>fill xfem_quadrature</p>
<div class="fragment"><div class="line"><a class="code" href="classPoint.html">Point&lt;dim&gt;</a> subcell_vertices[6];</div><div class="line">subcell_vertices[0] = v0;</div><div class="line">subcell_vertices[1] = v1;</div><div class="line">subcell_vertices[2] = v2;</div><div class="line">subcell_vertices[3] = v3;</div><div class="line">subcell_vertices[4] = A;</div><div class="line">subcell_vertices[5] = B;</div><div class="line"></div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; xfem_points;</div><div class="line">std::vector&lt;double&gt;      xfem_weights;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (dim==2)</div><div class="line">  {</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell_v_indices[2][2][4] =</div><div class="line">    {</div><div class="line">      {{0,1,4,5}, {4,5,2,3}},</div><div class="line">      {{0,4,2,5}, {4,1,5,3}}</div><div class="line">    };</div></div><!-- fragment --><p>std::cout &lt;&lt; "Pos : " &lt;&lt; Pos &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell = 0; subcell&lt;2; subcell++)</div><div class="line">  {</div></div><!-- fragment --><p>std::cout &lt;&lt; "subcell : " &lt;&lt; subcell &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; vertices;</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;4; i++)</div><div class="line">  {</div><div class="line">    vertices.push_back( subcell_vertices[subcell_v_indices[Pos][subcell][i]] );</div></div><!-- fragment --><p>std::cout &lt;&lt; "i : " &lt;&lt; i &lt;&lt; std::endl; std::cout &lt;&lt; "subcell v : " &lt;&lt; subcell_v_indices[Pos][subcell][i] &lt;&lt; std::endl; std::cout &lt;&lt; vertices[i](0) &lt;&lt; " " &lt;&lt; vertices[i](1) &lt;&lt; std::endl;</p>
<div class="fragment"><div class="line">}</div></div><!-- fragment --><p>std::cout &lt;&lt; std::endl; create quadrature rule</p>
<div class="fragment"><div class="line">append_quadrature( plain_quadrature,</div><div class="line">                   vertices,</div><div class="line">                   xfem_points,</div><div class="line">                   xfem_weights);</div></div><!-- fragment --><p>initialize xfem_quadrature with quadrature points of all subelements</p>
<div class="fragment"><div class="line">              xfem_quadrature.initialize(xfem_points, xfem_weights);</div><div class="line">            }</div><div class="line">        }</div><div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (xfem_quadrature.size() == plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>() * 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">      <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(3, xfem_quadrature);</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(0, plain_quadrature);;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::append_quadrature ( <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                                              <span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;v,</div><div class="line">                                              std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;xfem_points,</div><div class="line">                                              std::vector&lt;double&gt;      &amp;xfem_weights)</div><div class="line"></div><div class="line">{</div></div><!-- fragment --><p>Project integration points into sub-elements. This maps quadrature points from a reference element to a subelement of a reference element. To implement the action of this map the coordinates of the subelements have been calculated (A(0)...F(0),A(1)...F(1)) the coordinates of the quadrature points are given by the bi-linear map defined by the form functions <img class="formulaInl" alt="$x^\prime_i = \sum_j v^\prime \phi_j(x^hat_i)$" src="form_3872.png"/>, where the <img class="formulaInl" alt="$\phi_j$" src="form_526.png"/> are the shape functions of the FEQ.</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_v = <a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>;</div><div class="line"></div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; q_points = plain_quadrature.<a class="code" href="classQuadrature.html#a20007f9b06ab67a53f72cb6c36ae945b">get_points</a>();</div><div class="line">std::vector&lt;Point&lt;dim&gt; &gt; q_transf(q_points.size());</div><div class="line">std::vector&lt;double&gt; W = plain_quadrature.<a class="code" href="classQuadrature.html#a7fccd5bd9ad466dd5aae72b0fe12091d">get_weights</a>();</div><div class="line">std::vector&lt;double&gt; phi(n_v);</div><div class="line">std::vector&lt;Tensor&lt;1,dim&gt; &gt; grad_phi(n_v);</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line">std::vector&lt;double&gt; JxW(n_q_points);</div><div class="line"></div><div class="line"><span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_q_points; i++)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">switch</span> (dim)</div><div class="line">      {</div><div class="line">      <span class="keywordflow">case</span> 2:</div><div class="line">      {</div><div class="line">        <span class="keywordtype">double</span> xi  = q_points[i](0);</div><div class="line">        <span class="keywordtype">double</span> eta = q_points[i](1);</div></div><!-- fragment --><p>Define shape functions on reference element we consider a bi-linear mapping</p>
<div class="fragment"><div class="line">    phi[0] = (1. - xi) * (1. - eta);</div><div class="line">    phi[1] = xi * (1. - eta);</div><div class="line">    phi[2] = (1. - xi) * eta;</div><div class="line">    phi[3] = xi * eta;</div><div class="line"></div><div class="line">    grad_phi[0][0] = (-1. + eta);</div><div class="line">    grad_phi[1][0] = (1. - eta);</div><div class="line">    grad_phi[2][0] = -eta;</div><div class="line">    grad_phi[3][0] = eta;</div><div class="line"></div><div class="line">    grad_phi[0][1] = (-1. + xi);</div><div class="line">    grad_phi[1][1] = -xi;</div><div class="line">    grad_phi[2][1] = 1-xi;</div><div class="line">    grad_phi[3][1] = xi;</div><div class="line"></div><div class="line">    <span class="keywordflow">break</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">default</span>:</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="classTensor.html">Tensor&lt;2,dim&gt;</a> jacobian;</div></div><!-- fragment --><p>Calculate Jacobian of transformation</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d=0; d&lt;dim; ++d)</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> e=0; e&lt;dim; ++e)</div><div class="line">    {</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; j++)</div><div class="line">        {</div><div class="line">          jacobian[d][e] += grad_phi[j][e] * v[j](d);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> detJ = <a class="code" href="classSymmetricTensor.html#a31d48ca1d251a7a32db8b673e6010193">determinant</a>(jacobian);</div><div class="line">xfem_weights.push_back (W[i] * detJ);</div></div><!-- fragment --><p>Map integration points from reference element to subcell of reference element</p>
<div class="fragment"><div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> q_prime;</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d=0; d&lt;dim; ++d)</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; j++)</div><div class="line">          q_prime[d] += v[j](d) * phi[j];</div><div class="line">      xfem_points.push_back(q_prime);</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::solve ()</div><div class="line">{</div><div class="line">  <a class="code" href="classSolverControl.html">SolverControl</a>           solver_control (1000, 1e-12);</div><div class="line">  <a class="code" href="classSolverCG.html">SolverCG&lt;&gt;</a>              solver (solver_control);</div><div class="line"></div><div class="line">  <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;&gt;</a> preconditioner;</div><div class="line">  preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"></div><div class="line">  solver.solve (system_matrix, solution, system_rhs,</div><div class="line">                preconditioner);</div><div class="line"></div><div class="line">  constraints.distribute (solution);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::refine_grid ()</div><div class="line">{</div><div class="line">  <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell (triangulation.<a class="code" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">n_active_cells</a>());</div><div class="line"></div><div class="line">  <a class="code" href="classKellyErrorEstimator.html#a971b0bfe57fa21867ed3c06794487e4b">KellyErrorEstimator&lt;dim&gt;::estimate</a> (dof_handler,</div><div class="line">                                      <a class="code" href="classQGauss.html">QGauss&lt;dim-1&gt;</a>(3),</div><div class="line">                                      <span class="keyword">typename</span> <a class="code" href="structFunctionMap.html#a6bb95bc991dd3337330f1c725f59b008">FunctionMap&lt;dim&gt;::type</a>(),</div><div class="line">                                      solution,</div><div class="line">                                      estimated_error_per_cell);</div><div class="line"></div><div class="line">  <a class="code" href="namespaceGridRefinement.html#a2500638aae40fe3bfbf094754645dc57">GridRefinement::refine_and_coarsen_fixed_number</a> (triangulation,</div><div class="line">                                                   estimated_error_per_cell,</div><div class="line">                                                   0.3, 0.03);</div><div class="line"></div><div class="line">  triangulation.<a class="code" href="classTriangulation.html#ac8b4fbb207303ec7f5ef758821ecd8cb">execute_coarsening_and_refinement</a> ();</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="keyword">virtual</span></div><div class="line">  <span class="keywordtype">void</span></div><div class="line">  <a class="code" href="classDataPostprocessor.html#ac907e98f8f03ea7e6ac25237271dc7b7">evaluate_vector_field</a></div><div class="line">  (const ::DataPostprocessorInputs::Vector&lt;dim&gt; &amp;inputs,</div><div class="line">   std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &gt;                       &amp;computed_quantities) <span class="keyword">const</span>;</div><div class="line"></div><div class="line">  <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="classDataPostprocessor.html#a254f38bcdf4bdb5aa94231b695da7d55">get_names</a> () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">  <span class="keyword">virtual</span></div><div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">  <a class="code" href="classDataPostprocessor.html#ae994223acf8a16471ab5e579a4d75053">get_data_component_interpretation</a> () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">  <span class="keyword">virtual</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="classDataPostprocessor.html#aadecdd040447b395164397ea1196f721">get_needed_update_flags</a> () <span class="keyword">const</span>;</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">std::vector&lt;std::string&gt;</div><div class="line">Postprocessor&lt;dim&gt;::get_names()<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  std::vector&lt;std::string&gt; solution_names (1, <span class="stringliteral">&quot;total_solution&quot;</span>);</div><div class="line">  solution_names.push_back (<span class="stringliteral">&quot;error&quot;</span>);</div><div class="line">  <span class="keywordflow">return</span> solution_names;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">Postprocessor&lt;dim&gt;::</div><div class="line">get_data_component_interpretation ()<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">  interpretation (2,</div><div class="line">                  <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div><div class="line">  <span class="keywordflow">return</span> interpretation;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="line">Postprocessor&lt;dim&gt;::get_needed_update_flags()<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <span class="keywordflow">return</span> <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa49a49d892021457f921318905c408e25">update_q_points</a>;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span></div><div class="line">Postprocessor&lt;dim&gt;::</div><div class="line">evaluate_vector_field</div><div class="line">(const ::DataPostprocessorInputs::Vector&lt;dim&gt; &amp;inputs,</div><div class="line"> std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &gt;                       &amp;computed_quantities)<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points = inputs.solution_values.size();</div><div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (computed_quantities.size() == n_quadrature_points,</div><div class="line">          <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (inputs.solution_values[0].size() == 2,</div><div class="line">          <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q=0; q&lt;n_quadrature_points; ++q)</div><div class="line">    {</div><div class="line">      computed_quantities[q](0)</div><div class="line">        = (inputs.solution_values[q](0)</div><div class="line">           +</div></div><!-- fragment --><p>TODO: shift in weight function is missing!</p>
<div class="fragment"><div class="line">           inputs.solution_values[q](1) * std::fabs(level_set(inputs.evaluation_points[q])));</div><div class="line">      computed_quantities[q](1)</div><div class="line">        = (computed_quantities[q](0)</div><div class="line">           -</div><div class="line">           exact_solution (inputs.evaluation_points[q]));</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::output_results (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (cycle &lt; 10, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line"></div><div class="line">  std::string filename = <span class="stringliteral">&quot;solution-&quot;</span>;</div><div class="line">  filename += (<span class="charliteral">&#39;0&#39;</span> + cycle);</div><div class="line">  filename += <span class="stringliteral">&quot;.vtk&quot;</span>;</div><div class="line"></div><div class="line">  std::ofstream output (filename.c_str());</div><div class="line"></div><div class="line">  Postprocessor&lt;dim&gt; postprocessor;</div><div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim,hp::DoFHandler&lt;dim&gt;</a> &gt; data_out;</div><div class="line"></div><div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a> (dof_handler);</div><div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a> (solution, <span class="stringliteral">&quot;solution&quot;</span>);</div><div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a> (solution, postprocessor);</div><div class="line">  data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a> (5);</div><div class="line"></div><div class="line">  data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a> (output);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::compute_error ()<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <a class="code" href="classhp_1_1QCollection.html">hp::QCollection&lt;dim&gt;</a> q_collection;</div><div class="line">  q_collection.<a class="code" href="classhp_1_1QCollection.html#a166f1c95b492e6293215998210caf605">push_back</a> (<a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2));</div><div class="line">  q_collection.<a class="code" href="classhp_1_1QCollection.html#a166f1c95b492e6293215998210caf605">push_back</a> (<a class="code" href="classQIterated.html">QIterated&lt;dim&gt;</a>(<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(2), 4));</div><div class="line"></div><div class="line">  <a class="code" href="classhp_1_1FEValues.html">hp::FEValues&lt;dim&gt;</a> hp_fe_values (fe_collection, q_collection,</div><div class="line">                                  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa49a49d892021457f921318905c408e25">update_q_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"></div><div class="line">  <span class="keywordtype">double</span> l2_error_square = 0;</div><div class="line"></div><div class="line">  std::vector&lt;Vector&lt;double&gt; &gt; solution_values;</div><div class="line"></div><div class="line">  <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a></div><div class="line">  cell = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>(),</div><div class="line">  endc = dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>();</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span> (; cell!=endc; ++cell)</div><div class="line">    {</div><div class="line">      hp_fe_values.reinit (cell);</div><div class="line"></div><div class="line">      <span class="keyword">const</span> <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> &amp;fe_values = hp_fe_values.<a class="code" href="classFEValues.html#a4bc26790261f1f9f4cc7e8e69e3d7920">get_present_fe_values</a> ();</div><div class="line"></div><div class="line">      solution_values.resize (fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>,</div><div class="line">                              <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(2));</div><div class="line">      fe_values.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a> (solution,</div><div class="line">                                     solution_values);</div><div class="line"></div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q=0; q&lt;fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++q)</div><div class="line">        {</div><div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> local_error = (solution_values[q](0)</div><div class="line">                                      +</div><div class="line">                                      std::fabs(level_set(fe_values.<a class="code" href="classFEValuesBase.html#ab123e5da03736be4977c76fbcb6a2e37">quadrature_point</a>(q))) *</div><div class="line">                                      solution_values[q](1)</div><div class="line">                                      -</div><div class="line">                                      exact_solution (fe_values.<a class="code" href="classFEValuesBase.html#ab123e5da03736be4977c76fbcb6a2e37">quadrature_point</a>(q)));</div><div class="line">          l2_error_square += local_error * local_error * fe_values.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;   L2 error = &quot;</span> &lt;&lt; std::sqrt (l2_error_square)</div><div class="line">            &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::run ()</div><div class="line">{</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle=0; cycle&lt;6; ++cycle)</div><div class="line">    {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; cycle &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (cycle == 0)</div><div class="line">        {</div><div class="line">          <a class="code" href="namespaceGridGenerator.html#a0a81f736ef95164a9d9bf0f844ac682b">GridGenerator::hyper_ball</a> (triangulation);</div></div><!-- fragment --><p><a class="el" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a> (triangulation, -1, 1);</p>
<div class="fragment"><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold&lt;dim&gt;</a> boundary;</div><div class="line">    triangulation.<a class="code" href="group__manifold.html#ga1f1ea841946c94c079388ecf9ad2c00c">set_all_manifold_ids_on_boundary</a>(0);</div><div class="line">    triangulation.<a class="code" href="group__manifold.html#ga9f9d720f5fbdcdf3dcbb445feefbdb9f">set_manifold</a> (0, boundary);</div><div class="line"></div><div class="line">    triangulation.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a> (2);</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span></div><div class="line">  triangulation.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a> (1);</div></div><!-- fragment --><p>refine_grid ();</p>
<div class="fragment"><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span></div><div class="line">                  &lt;&lt; triangulation.<a class="code" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">n_active_cells</a>()</div><div class="line">                  &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        setup_system ();</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span></div><div class="line">                  &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div><div class="line">                  &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        assemble_system ();</div><div class="line">        solve ();</div><div class="line">        compute_error ();</div><div class="line">        output_results (cycle);</div><div class="line">      }</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line"></div><div class="line">  <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div><div class="line">      <span class="keyword">using namespace </span>Step47;</div><div class="line"></div><div class="line">      LaplaceProblem&lt;2&gt; laplace_problem_2d;</div><div class="line">      laplace_problem_2d.run ();</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line"></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (...)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Copyright (C) 2011 - 2017 by the deal.II authors</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div><div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div><div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE at</span></div><div class="line"><span class="comment"> * the top level of the deal.II distribution.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Author: Wolfgang Bangerth, University of Heidelberg, 2000</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/quadrature_lib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/function.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/logstream.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/vector.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/full_matrix.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/sparse_matrix.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/dynamic_sparsity_pattern.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/solver_cg.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/precondition.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_handler.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_generator.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria_accessor.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/tria_iterator.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/manifold_lib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_accessor.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/dofs/dof_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_q.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_nothing.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_system.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_values.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/vector_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/matrix_tools.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/data_out.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/fe/fe_q.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_out.h&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/lac/constraint_matrix.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/grid/grid_refinement.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/numerics/error_estimator.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span>Step47</div><div class="line">{</div><div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">double</span> sign (<span class="keywordtype">double</span> d)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (d &gt; 0)</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d &lt; 0)</div><div class="line">      <span class="keywordflow">return</span> -1;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keyword">class </span>LaplaceProblem</div><div class="line">  {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    LaplaceProblem ();</div><div class="line">    ~LaplaceProblem ();</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> run ();</div><div class="line"></div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="keywordtype">bool</span> interface_intersects_cell (<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a> &amp;cell) <span class="keyword">const</span>;</div><div class="line">    std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt; compute_quadrature(<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature, <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;level_set_values);</div><div class="line">    <span class="keywordtype">void</span> append_quadrature(<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                           <span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;v      ,</div><div class="line">                           std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;xfem_points,</div><div class="line">                           std::vector&lt;double&gt;      &amp;xfem_weights);</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> setup_system ();</div><div class="line">    <span class="keywordtype">void</span> assemble_system ();</div><div class="line">    <span class="keywordtype">void</span> solve ();</div><div class="line">    <span class="keywordtype">void</span> refine_grid ();</div><div class="line">    <span class="keywordtype">void</span> output_results (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle) <span class="keyword">const</span>;</div><div class="line">    <span class="keywordtype">void</span> compute_error () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a>    triangulation;</div><div class="line"></div><div class="line">    <a class="code" href="classhp_1_1DoFHandler.html">hp::DoFHandler&lt;dim&gt;</a>   dof_handler;</div><div class="line">    <a class="code" href="classhp_1_1FECollection.html">hp::FECollection&lt;dim&gt;</a> fe_collection;</div><div class="line"></div><div class="line">    <a class="code" href="classConstraintMatrix.html">ConstraintMatrix</a>      constraints;</div><div class="line"></div><div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a>       sparsity_pattern;</div><div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a>  system_matrix;</div><div class="line"></div><div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>        solution;</div><div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>        system_rhs;</div><div class="line">  };</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keyword">class </span>Coefficient : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line">  {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Coefficient () : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;() {}</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> value (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>   &amp;p,</div><div class="line">                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  component = 0) <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> value_list (<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;points,</div><div class="line">                             std::vector&lt;double&gt;            &amp;values,</div><div class="line">                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              component = 0) <span class="keyword">const</span>;</div><div class="line">  };</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span> Coefficient&lt;dim&gt;::value (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line">                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">if</span> (p.<a class="code" href="classPoint.html#a859ea7f3bf3e64be2e0f5ed1bfcc8550">square</a>() &lt; 0.5*0.5)</div><div class="line">      <span class="keywordflow">return</span> 20;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> Coefficient&lt;dim&gt;::value_list (<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;points,</div><div class="line">                                     std::vector&lt;double&gt;            &amp;values,</div><div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              component)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_points = points.size();</div><div class="line"></div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (values.size() == n_points,</div><div class="line">            <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a> (values.size(), n_points));</div><div class="line"></div><div class="line">    (void) component;</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_points; ++i)</div><div class="line">      {</div><div class="line">        <span class="keywordflow">if</span> (points[i].square() &lt; 0.5*0.5)</div><div class="line">          values[i] = 20;</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          values[i] = 1;</div><div class="line">      }</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span> exact_solution (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> r = p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> (r &lt; 0.5</div><div class="line">            ?</div><div class="line">            1./20 * (-1./4*r*r + 61./16)</div><div class="line">            :</div><div class="line">            1./4 * (1-r*r));</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  LaplaceProblem&lt;dim&gt;::LaplaceProblem ()</div><div class="line">    :</div><div class="line">    dof_handler (triangulation)</div><div class="line">  {</div><div class="line">    fe_collection.<a class="code" href="classhp_1_1FECollection.html#a4b0e75a805ff012e76d33ad6d4c3eac8">push_back</a> (<a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a> (<a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1,</div><div class="line">                                            <a class="code" href="classFE__Nothing.html">FE_Nothing&lt;dim&gt;</a>(), 1));</div><div class="line">    fe_collection.<a class="code" href="classhp_1_1FECollection.html#a4b0e75a805ff012e76d33ad6d4c3eac8">push_back</a> (<a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a> (<a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1,</div><div class="line">                                            <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(1), 1));</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  LaplaceProblem&lt;dim&gt;::~LaplaceProblem ()</div><div class="line">  {</div><div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#ad316958f8045d9a48094335b23a03a53">clear</a> ();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">double</span></div><div class="line">  level_set (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>() - 0.5;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1,dim&gt;</a></div><div class="line">  grad_level_set (<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> p / p.<a class="code" href="classTensor.html#a4df6cb10807fbe5fb432a19b5ef9aeb6">norm</a>();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">bool</span></div><div class="line">  LaplaceProblem&lt;dim&gt;::</div><div class="line">  interface_intersects_cell (<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a> &amp;cell)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell-1; ++v)</div><div class="line">      <span class="keywordflow">if</span> (level_set(cell-&gt;vertex(v)) * level_set(cell-&gt;vertex(v+1)) &lt; 0)</div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::setup_system ()</div><div class="line">  {</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code" href="group__Iterators.html#ga60277a8a3957ba4b41c1e76a87decd30">hp::DoFHandler&lt;dim&gt;::cell_iterator</a> cell</div><div class="line">         = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>();</div><div class="line">         cell != dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>(); ++cell)</div><div class="line">      <span class="keywordflow">if</span> (interface_intersects_cell(cell) == <span class="keyword">false</span>)</div><div class="line">        cell-&gt;set_active_fe_index(0);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">        cell-&gt;set_active_fe_index(1);</div><div class="line"></div><div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a> (fe_collection);</div><div class="line"></div><div class="line">    solution.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line">    system_rhs.<a class="code" href="classBlockVector.html#adf4d1d6c3538af95309a95da2ded758c">reinit</a> (dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line"></div><div class="line"></div><div class="line">    constraints.clear ();</div><div class="line"></div><div class="line">    constraints.close();</div><div class="line"></div><div class="line"></div><div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div><div class="line">    <a class="code" href="group__constraints.html#ga38d88a1a559e9fc65d60f3e168921ba5">DoFTools::make_sparsity_pattern</a> (dof_handler, dsp);</div><div class="line"></div><div class="line">    constraints.condense (dsp);</div><div class="line"></div><div class="line">    sparsity_pattern.<a class="code" href="classBlockSparsityPattern.html#a923288e4b4093f86b680e7045e9b4984">copy_from</a>(dsp);</div><div class="line"></div><div class="line">    system_matrix.reinit (sparsity_pattern);</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::assemble_system ()</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>  quadrature_formula(3);</div><div class="line"></div><div class="line"></div><div class="line">    <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> plain_fe_values (fe_collection[0], quadrature_formula,</div><div class="line">                                   <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>    |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line">                                   <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>  |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = quadrature_formula.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line">    <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a>   cell_matrix;</div><div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>       cell_rhs;</div><div class="line"></div><div class="line">    std::vector&lt;types::global_dof_index&gt; local_dof_indices;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> Coefficient&lt;dim&gt; coefficient;</div><div class="line">    std::vector&lt;double&gt;    coefficient_values (n_q_points);</div><div class="line"></div><div class="line">    <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a></div><div class="line">    cell = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>(),</div><div class="line">    endc = dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (; cell!=endc; ++cell)</div><div class="line">      {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().dofs_per_cell;</div><div class="line">        cell_matrix.<a class="code" href="classTableBase.html#a302ef67031a523602fd39911b968d6ab">reinit</a> (dofs_per_cell, dofs_per_cell);</div><div class="line">        cell_rhs.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (dofs_per_cell);</div><div class="line"></div><div class="line">        cell_matrix = 0;</div><div class="line">        cell_rhs = 0;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (cell-&gt;active_fe_index() == 0)</div><div class="line">          {</div><div class="line">            plain_fe_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a> (cell);</div><div class="line"></div><div class="line">            coefficient_values.resize (plain_fe_values.n_quadrature_points);</div><div class="line">            coefficient.value_list (plain_fe_values.get_quadrature_points(),</div><div class="line">                                    coefficient_values);</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point=0; q_point&lt;n_q_points; ++q_point)</div><div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dofs_per_cell; ++i)</div><div class="line">                {</div><div class="line">                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                    cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                         plain_fe_values.shape_grad(i,q_point) *</div><div class="line">                                         plain_fe_values.shape_grad(j,q_point) *</div><div class="line">                                         plain_fe_values.JxW(q_point));</div><div class="line"></div><div class="line"></div><div class="line">                  cell_rhs(i) += (plain_fe_values.shape_value(i,q_point) *</div><div class="line">                                  1.0 *</div><div class="line">                                  plain_fe_values.JxW(q_point));</div><div class="line">                }</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          {</div><div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (cell-&gt;active_fe_index() == 1, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (interface_intersects_cell(cell) == <span class="keyword">true</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"></div><div class="line">            std::vector&lt;double&gt; level_set_values (<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div><div class="line">              level_set_values[v] = level_set (cell-&gt;vertex(v));</div><div class="line"></div><div class="line">            <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> this_fe_values (fe_collection[1],</div><div class="line">                                          compute_quadrature(quadrature_formula, cell,</div><div class="line">                                                             level_set_values).second,</div><div class="line">                                          <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>    |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line">                                          <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>  |  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> );</div><div class="line"></div><div class="line">            this_fe_values.reinit (cell);</div><div class="line"></div><div class="line">            coefficient_values.resize (this_fe_values.n_quadrature_points);</div><div class="line">            coefficient.value_list (this_fe_values.get_quadrature_points(),</div><div class="line">                                    coefficient_values);</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point=0; q_point&lt;this_fe_values.n_quadrature_points; ++q_point)</div><div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dofs_per_cell; ++i)</div><div class="line">                <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).first == 0)</div><div class="line">                  {</div><div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                      <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).first == 0)</div><div class="line">                        cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                             this_fe_values.shape_grad(i,q_point) *</div><div class="line">                                             this_fe_values.shape_grad(j,q_point) *</div><div class="line">                                             this_fe_values.JxW(q_point));</div><div class="line">                      <span class="keywordflow">else</span></div><div class="line">                        cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                             this_fe_values.shape_grad(i,q_point)</div><div class="line">                                             *</div><div class="line">                                             ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                               -</div><div class="line">                                               std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).second))))*</div><div class="line">                                              this_fe_values.shape_grad(j,q_point)</div><div class="line">                                              +</div><div class="line">                                              grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                              sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                              this_fe_values.shape_value(j,q_point)) *</div><div class="line">                                             this_fe_values.JxW(q_point));</div><div class="line"></div><div class="line">                    cell_rhs(i) += (this_fe_values.shape_value(i,q_point) *</div><div class="line">                                    1.0 *</div><div class="line">                                    this_fe_values.JxW(q_point));</div><div class="line">                  }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                  {</div><div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dofs_per_cell; ++j)</div><div class="line">                      <span class="keywordflow">if</span> (cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).first == 0)</div><div class="line">                        cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                             ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                               -</div><div class="line">                                               std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                              this_fe_values.shape_grad(i,q_point)</div><div class="line">                                              +</div><div class="line">                                              grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                              sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                              this_fe_values.shape_value(i,q_point)) *</div><div class="line">                                             this_fe_values.shape_grad(j,q_point) *</div><div class="line">                                             this_fe_values.JxW(q_point));</div><div class="line">                      <span class="keywordflow">else</span></div><div class="line">                        cell_matrix(i,j) += (coefficient_values[q_point] *</div><div class="line">                                             ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                               -</div><div class="line">                                               std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                              this_fe_values.shape_grad(i,q_point)</div><div class="line">                                              +</div><div class="line">                                              grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                              sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                              this_fe_values.shape_value(i,q_point)) *</div><div class="line">                                             ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                               -</div><div class="line">                                               std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(j).second))))*</div><div class="line">                                              this_fe_values.shape_grad(j,q_point)</div><div class="line">                                              +</div><div class="line">                                              grad_level_set(this_fe_values.quadrature_point(q_point)) *</div><div class="line">                                              sign(level_set(this_fe_values.quadrature_point(q_point))) *</div><div class="line">                                              this_fe_values.shape_value(j,q_point)) *</div><div class="line">                                             this_fe_values.JxW(q_point));</div><div class="line"></div><div class="line">                    cell_rhs(i) += ((std::fabs(level_set(this_fe_values.quadrature_point(q_point)))</div><div class="line">                                     -</div><div class="line">                                     std::fabs(level_set(cell-&gt;vertex(cell-&gt;<a class="code" href="classhp_1_1DoFHandler.html#ae51d585fc36bf7f4b4ddbe24b7559ac7">get_fe</a>().system_to_component_index(i).second))))*</div><div class="line">                                    this_fe_values.shape_value(i,q_point) *</div><div class="line">                                    1.0 *</div><div class="line">                                    this_fe_values.JxW(q_point));</div><div class="line">                  }</div><div class="line">          }</div><div class="line"></div><div class="line">        local_dof_indices.resize (dofs_per_cell);</div><div class="line">        cell-&gt;get_dof_indices (local_dof_indices);</div><div class="line">        constraints.distribute_local_to_global (cell_matrix, cell_rhs,</div><div class="line">                                                local_dof_indices,</div><div class="line">                                                system_matrix, system_rhs);</div><div class="line">      }</div><div class="line"></div><div class="line"></div><div class="line">    std::map&lt;types::global_dof_index,double&gt; boundary_values;</div><div class="line">    <a class="code" href="namespaceVectorTools.html#a187aeb575be07bc47cb3dea1a47aaf88">VectorTools::interpolate_boundary_values</a> (dof_handler,</div><div class="line">                                              0,</div><div class="line">                                              <a class="code" href="classZeroFunction.html">ZeroFunction&lt;dim&gt;</a>(2),</div><div class="line">                                              boundary_values);</div><div class="line">    <a class="code" href="namespaceMatrixTools.html#a9ad0eb7a8662628534586716748d62fb">MatrixTools::apply_boundary_values</a> (boundary_values,</div><div class="line">                                        system_matrix,</div><div class="line">                                        solution,</div><div class="line">                                        system_rhs);</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;</div><div class="line">  LaplaceProblem&lt;dim&gt;::compute_quadrature (<span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                                           <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;<span class="comment">/*cell*/</span>,</div><div class="line">                                           <span class="keyword">const</span> std::vector&lt;double&gt; &amp;level_set_values)</div><div class="line">  {</div><div class="line"></div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> type = 0;</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> sign_ls[<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>];</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div><div class="line">      {</div><div class="line">        <span class="keywordflow">if</span> (level_set_values[v] &gt; 0) sign_ls[v] = 1;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (level_set_values[v] &lt; 0) sign_ls[v] = -1;</div><div class="line">        <span class="keywordflow">else</span> sign_ls[v] = 0;</div><div class="line">      }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[1] &amp;&amp;</div><div class="line">         sign_ls[0]==sign_ls[2] &amp;&amp;</div><div class="line">         sign_ls[0]==sign_ls[3] )</div><div class="line">      type = 1;</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]*sign_ls[1]*sign_ls[2]*sign_ls[3] &lt; 0 )</div><div class="line">      type = 2;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      type = 3;</div><div class="line"></div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Pos = 100;</div><div class="line"></div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v0(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v1(1,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v2(0,1);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> v3(1,1);</div><div class="line"></div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> A(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> B(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> D(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0,0);</div><div class="line">    <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> F(0,0);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (type == 1)</div><div class="line">      <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(1, plain_quadrature);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (type==2)</div><div class="line">      {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line"></div><div class="line">        <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> xfem_quadrature(5*n_q_points);</div><div class="line"></div><div class="line">        std::vector&lt;Point&lt;dim&gt; &gt; v(<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (sign_ls[0]!=sign_ls[1] &amp;&amp; sign_ls[0]!=sign_ls[2] &amp;&amp; sign_ls[0]!=sign_ls[3]) Pos = 0;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[1]!=sign_ls[0] &amp;&amp; sign_ls[1]!=sign_ls[2] &amp;&amp; sign_ls[1]!=sign_ls[3]) Pos = 1;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[2]!=sign_ls[0] &amp;&amp; sign_ls[2]!=sign_ls[1] &amp;&amp; sign_ls[2]!=sign_ls[3]) Pos = 2;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sign_ls[3]!=sign_ls[0] &amp;&amp; sign_ls[3]!=sign_ls[1] &amp;&amp; sign_ls[3]!=sign_ls[2]) Pos = 3;</div><div class="line">        <span class="keywordflow">else</span> assert(0); <span class="comment">// error message</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (Pos == 0)</div><div class="line">          {</div><div class="line">            A[0] = 1. - level_set_values[1]/(level_set_values[1]-level_set_values[0]);</div><div class="line">            B[1] = 1. - level_set_values[2]/(level_set_values[2]-level_set_values[0]);</div><div class="line">            A(1) = 0.;</div><div class="line">            B(0) = 0.;</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">            D(0) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">            D(1) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*A(0);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 0.;</div><div class="line">            F(0) = 0.;</div><div class="line">            F(1) = 0.5*B(1);</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 1)</div><div class="line">          {</div><div class="line">            A[0] = level_set_values[0]/(level_set_values[0]-level_set_values[1]);</div><div class="line">            B[1] = 1 - level_set_values[3]/(level_set_values[3]-level_set_values[1]);</div><div class="line">            A(1) = 0.;</div><div class="line">            B(0) = 1.;</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">            D(0) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">            D(1) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*(1 + A(0));</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 0.;</div><div class="line">            F(0) = 1.;</div><div class="line">            F(1) = 0.5*B(1);</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 2)</div><div class="line">          {</div><div class="line">            A[0] = 1 - level_set_values[3]/(level_set_values[3]-level_set_values[2]);</div><div class="line">            B[1] = level_set_values[0]/(level_set_values[0]-level_set_values[2]);</div><div class="line">            A(1) = 1.;</div><div class="line">            B(0) = 0.;</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">            D(0) = 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">            D(1) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5* A(0);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 1.;</div><div class="line">            F(0) = 0.;</div><div class="line">            F(1) = 0.5*( 1. + B(1) );</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos == 3)</div><div class="line">          {</div><div class="line">            A[0] = level_set_values[2]/(level_set_values[2]-level_set_values[3]);</div><div class="line">            B[1] = level_set_values[1]/(level_set_values[1]-level_set_values[3]);</div><div class="line">            A(1) = 1.;</div><div class="line">            B(0) = 1.;</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) = 0.5*( A(0) + B(0) );</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) = 0.5*( A(1) + B(1) );</div><div class="line">            D(0) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0);</div><div class="line">            D(1) = 1./3. + 2./3. * <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1);</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) = 0.5*( 1. + A(0) );</div><div class="line">            <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) = 1.;</div><div class="line">            F(0) = 1.;</div><div class="line">            F(1) = 0.5*( 1. + B(1) );</div><div class="line">          }</div><div class="line"></div><div class="line"></div><div class="line">        std::string filename = <span class="stringliteral">&quot;vertices.dat&quot;</span>;</div><div class="line">        std::ofstream output (filename.c_str());</div><div class="line">        output &lt;&lt; <span class="stringliteral">&quot;#vertices of xfem subcells&quot;</span> &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; v0(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v0(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; v1(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v1(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; v3(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v3(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; v2(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v2(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; A(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; A(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; B(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; B(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; D(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; D(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; F(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; F(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (Pos==0)</div><div class="line">          output &lt;&lt; v3(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v3(1) &lt;&lt; std::endl;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==1)</div><div class="line">          output &lt;&lt; v2(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v2(1) &lt;&lt; std::endl;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==2)</div><div class="line">          output &lt;&lt; v1(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v1(1) &lt;&lt; std::endl;</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pos==3)</div><div class="line">          output &lt;&lt; v0(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; v0(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>(1) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> subcell_vertices[10];</div><div class="line">        subcell_vertices[0] = v0;</div><div class="line">        subcell_vertices[1] = v1;</div><div class="line">        subcell_vertices[2] = v2;</div><div class="line">        subcell_vertices[3] = v3;</div><div class="line">        subcell_vertices[4] = A;</div><div class="line">        subcell_vertices[5] = B;</div><div class="line">        subcell_vertices[6] = <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>;</div><div class="line">        subcell_vertices[7] = D;</div><div class="line">        subcell_vertices[8] = <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae607c6743e1481e02d0eb75cd4e32e78">E</a>;</div><div class="line">        subcell_vertices[9] = F;</div><div class="line"></div><div class="line">        std::vector&lt;Point&lt;dim&gt; &gt; xfem_points;</div><div class="line">        std::vector&lt;double&gt;      xfem_weights;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (dim==2)</div><div class="line">          {</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell_v_indices[4][5][4] =</div><div class="line">            {</div><div class="line">              {{0,8,9,7}, {9,7,5,6}, {8,4,7,6}, {5,6,2,3}, {6,4,3,1}},</div><div class="line">              {{8,1,7,9}, {4,8,6,7}, {6,7,5,9}, {0,4,2,6}, {2,6,3,5}},</div><div class="line">              {{9,7,2,8}, {5,6,9,7}, {6,4,7,8}, {0,1,5,6}, {6,1,4,3}},</div><div class="line">              {{7,9,8,3}, {4,6,8,7}, {6,5,7,9}, {0,6,2,4}, {0,1,6,5}}</div><div class="line">            };</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell = 0; subcell&lt;5; subcell++)</div><div class="line">              {</div><div class="line">                std::vector&lt;Point&lt;dim&gt; &gt; vertices;</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;4; i++)</div><div class="line">                  {</div><div class="line">                    vertices.push_back( subcell_vertices[subcell_v_indices[Pos][subcell][i]] );</div><div class="line">                  }</div><div class="line">                append_quadrature( plain_quadrature,</div><div class="line">                                   vertices,</div><div class="line">                                   xfem_points,</div><div class="line">                                   xfem_weights);</div><div class="line">                xfem_quadrature.initialize(xfem_points, xfem_weights);</div><div class="line">              }</div><div class="line">          }</div><div class="line"></div><div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (xfem_quadrature.size() == plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>() * 5, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">        <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(2, xfem_quadrature);</div><div class="line">      }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (type==3)</div><div class="line">      {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line"></div><div class="line">        <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> xfem_quadrature(5*n_q_points);</div><div class="line"></div><div class="line">        std::vector&lt;Point&lt;dim&gt; &gt; v(<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[1] &amp;&amp; sign_ls[2]==sign_ls[3] )</div><div class="line">          {</div><div class="line">            Pos = 0;</div><div class="line">            A(0) = 0.;</div><div class="line">            A(1) = level_set_values[0]/((level_set_values[0]-level_set_values[2]));</div><div class="line">            B(0) = 1.;</div><div class="line">            B(1) = level_set_values[1]/((level_set_values[1]-level_set_values[3]));</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[2] &amp;&amp; sign_ls[1]==sign_ls[3] )</div><div class="line">          {</div><div class="line">            Pos = 1;</div><div class="line">            A(0) = level_set_values[0]/((level_set_values[0]-level_set_values[1]));</div><div class="line">            A(1) = 0.;</div><div class="line">            B(0) = level_set_values[2]/((level_set_values[2]-level_set_values[3]));</div><div class="line">            B(1) = 1.;</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sign_ls[0]==sign_ls[3] &amp;&amp; sign_ls[1]==sign_ls[2] )</div><div class="line">          {</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Error: the element has two cut lines and this is not allowed&quot;</span> &lt;&lt; std::endl;</div><div class="line">            assert(0);</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          {</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Error: the level set function has not the right values&quot;</span> &lt;&lt; std::endl;</div><div class="line">            assert(0);</div><div class="line">          }</div><div class="line"></div><div class="line">        std::string filename = <span class="stringliteral">&quot;vertices.dat&quot;</span>;</div><div class="line">        std::ofstream output (filename.c_str());</div><div class="line">        output &lt;&lt; <span class="stringliteral">&quot;#vertices of xfem subcells&quot;</span> &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; A(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; A(1) &lt;&lt; std::endl;</div><div class="line">        output &lt;&lt; B(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; B(1) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> subcell_vertices[6];</div><div class="line">        subcell_vertices[0] = v0;</div><div class="line">        subcell_vertices[1] = v1;</div><div class="line">        subcell_vertices[2] = v2;</div><div class="line">        subcell_vertices[3] = v3;</div><div class="line">        subcell_vertices[4] = A;</div><div class="line">        subcell_vertices[5] = B;</div><div class="line"></div><div class="line">        std::vector&lt;Point&lt;dim&gt; &gt; xfem_points;</div><div class="line">        std::vector&lt;double&gt;      xfem_weights;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (dim==2)</div><div class="line">          {</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell_v_indices[2][2][4] =</div><div class="line">            {</div><div class="line">              {{0,1,4,5}, {4,5,2,3}},</div><div class="line">              {{0,4,2,5}, {4,1,5,3}}</div><div class="line">            };</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subcell = 0; subcell&lt;2; subcell++)</div><div class="line">              {</div><div class="line">                std::vector&lt;Point&lt;dim&gt; &gt; vertices;</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;4; i++)</div><div class="line">                  {</div><div class="line">                    vertices.push_back( subcell_vertices[subcell_v_indices[Pos][subcell][i]] );</div><div class="line">                  }</div><div class="line">                append_quadrature( plain_quadrature,</div><div class="line">                                   vertices,</div><div class="line">                                   xfem_points,</div><div class="line">                                   xfem_weights);</div><div class="line">                xfem_quadrature.initialize(xfem_points, xfem_weights);</div><div class="line">              }</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (xfem_quadrature.size() == plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>() * 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">        <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(3, xfem_quadrature);</div><div class="line">      }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> std::pair&lt;unsigned int, Quadrature&lt;dim&gt; &gt;(0, plain_quadrature);;</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::append_quadrature ( <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;dim&gt;</a> &amp;plain_quadrature,</div><div class="line">                                                <span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;v,</div><div class="line">                                                std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &gt; &amp;xfem_points,</div><div class="line">                                                std::vector&lt;double&gt;      &amp;xfem_weights)</div><div class="line"></div><div class="line">  {</div><div class="line"></div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_v = <a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::vertices_per_cell</a>;</div><div class="line"></div><div class="line">    std::vector&lt;Point&lt;dim&gt; &gt; q_points = plain_quadrature.<a class="code" href="classQuadrature.html#a20007f9b06ab67a53f72cb6c36ae945b">get_points</a>();</div><div class="line">    std::vector&lt;Point&lt;dim&gt; &gt; q_transf(q_points.size());</div><div class="line">    std::vector&lt;double&gt; W = plain_quadrature.<a class="code" href="classQuadrature.html#a7fccd5bd9ad466dd5aae72b0fe12091d">get_weights</a>();</div><div class="line">    std::vector&lt;double&gt; phi(n_v);</div><div class="line">    std::vector&lt;Tensor&lt;1,dim&gt; &gt; grad_phi(n_v);</div><div class="line"></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   n_q_points    = plain_quadrature.<a class="code" href="classQuadrature.html#af9f7d82770fa8126e19113f3e3db755b">size</a>();</div><div class="line"></div><div class="line">    std::vector&lt;double&gt; JxW(n_q_points);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_q_points; i++)</div><div class="line">      {</div><div class="line">        <span class="keywordflow">switch</span> (dim)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 2:</div><div class="line">          {</div><div class="line">            <span class="keywordtype">double</span> xi  = q_points[i](0);</div><div class="line">            <span class="keywordtype">double</span> eta = q_points[i](1);</div><div class="line"></div><div class="line">            phi[0] = (1. - xi) * (1. - eta);</div><div class="line">            phi[1] = xi * (1. - eta);</div><div class="line">            phi[2] = (1. - xi) * eta;</div><div class="line">            phi[3] = xi * eta;</div><div class="line"></div><div class="line">            grad_phi[0][0] = (-1. + eta);</div><div class="line">            grad_phi[1][0] = (1. - eta);</div><div class="line">            grad_phi[2][0] = -eta;</div><div class="line">            grad_phi[3][0] = eta;</div><div class="line"></div><div class="line">            grad_phi[0][1] = (-1. + xi);</div><div class="line">            grad_phi[1][1] = -xi;</div><div class="line">            grad_phi[2][1] = 1-xi;</div><div class="line">            grad_phi[3][1] = xi;</div><div class="line"></div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">          }</div><div class="line"></div><div class="line">          <span class="keywordflow">default</span>:</div><div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">          }</div><div class="line"></div><div class="line"></div><div class="line">        <a class="code" href="classTensor.html">Tensor&lt;2,dim&gt;</a> jacobian;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d=0; d&lt;dim; ++d)</div><div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> e=0; e&lt;dim; ++e)</div><div class="line">            {</div><div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; j++)</div><div class="line">                {</div><div class="line">                  jacobian[d][e] += grad_phi[j][e] * v[j](d);</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span> detJ = determinant(jacobian);</div><div class="line">        xfem_weights.push_back (W[i] * detJ);</div><div class="line"></div><div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> q_prime;</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d=0; d&lt;dim; ++d)</div><div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; j++)</div><div class="line">            q_prime[d] += v[j](d) * phi[j];</div><div class="line">        xfem_points.push_back(q_prime);</div><div class="line">      }</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::solve ()</div><div class="line">  {</div><div class="line">    <a class="code" href="classSolverControl.html">SolverControl</a>           solver_control (1000, 1e-12);</div><div class="line">    <a class="code" href="classSolverCG.html">SolverCG&lt;&gt;</a>              solver (solver_control);</div><div class="line"></div><div class="line">    <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;&gt;</a> preconditioner;</div><div class="line">    preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"></div><div class="line">    solver.solve (system_matrix, solution, system_rhs,</div><div class="line">                  preconditioner);</div><div class="line"></div><div class="line">    constraints.distribute (solution);</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::refine_grid ()</div><div class="line">  {</div><div class="line">    <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell (triangulation.<a class="code" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">n_active_cells</a>());</div><div class="line"></div><div class="line">    <a class="code" href="classKellyErrorEstimator.html#a971b0bfe57fa21867ed3c06794487e4b">KellyErrorEstimator&lt;dim&gt;::estimate</a> (dof_handler,</div><div class="line">                                        <a class="code" href="classQGauss.html">QGauss&lt;dim-1&gt;</a>(3),</div><div class="line">                                        <span class="keyword">typename</span> <a class="code" href="structFunctionMap.html#a6bb95bc991dd3337330f1c725f59b008">FunctionMap&lt;dim&gt;::type</a>(),</div><div class="line">                                        solution,</div><div class="line">                                        estimated_error_per_cell);</div><div class="line"></div><div class="line">    <a class="code" href="namespaceGridRefinement.html#a2500638aae40fe3bfbf094754645dc57">GridRefinement::refine_and_coarsen_fixed_number</a> (triangulation,</div><div class="line">                                                     estimated_error_per_cell,</div><div class="line">                                                     0.3, 0.03);</div><div class="line"></div><div class="line">    triangulation.<a class="code" href="classTriangulation.html#ac8b4fbb207303ec7f5ef758821ecd8cb">execute_coarsening_and_refinement</a> ();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div><div class="line">  {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    <span class="keyword">virtual</span></div><div class="line">    <span class="keywordtype">void</span></div><div class="line">    evaluate_vector_field</div><div class="line">    (const ::DataPostprocessorInputs::Vector&lt;dim&gt; &amp;inputs,</div><div class="line">     std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &gt;                       &amp;computed_quantities) <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> std::vector&lt;std::string&gt; get_names () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span></div><div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">    get_data_component_interpretation () <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> get_needed_update_flags () <span class="keyword">const</span>;</div><div class="line">  };</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  std::vector&lt;std::string&gt;</div><div class="line">  Postprocessor&lt;dim&gt;::get_names()<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    std::vector&lt;std::string&gt; solution_names (1, <span class="stringliteral">&quot;total_solution&quot;</span>);</div><div class="line">    solution_names.push_back (<span class="stringliteral">&quot;error&quot;</span>);</div><div class="line">    <span class="keywordflow">return</span> solution_names;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">  Postprocessor&lt;dim&gt;::</div><div class="line">  get_data_component_interpretation ()<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div><div class="line">    interpretation (2,</div><div class="line">                    <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div><div class="line">    <span class="keywordflow">return</span> interpretation;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="line">  Postprocessor&lt;dim&gt;::get_needed_update_flags()<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa49a49d892021457f921318905c408e25">update_q_points</a>;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span></div><div class="line">  Postprocessor&lt;dim&gt;::</div><div class="line">  evaluate_vector_field</div><div class="line">  (const ::DataPostprocessorInputs::Vector&lt;dim&gt; &amp;inputs,</div><div class="line">   std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &gt;                       &amp;computed_quantities)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points = inputs.solution_values.size();</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (computed_quantities.size() == n_quadrature_points,</div><div class="line">            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (inputs.solution_values[0].size() == 2,</div><div class="line">            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q=0; q&lt;n_quadrature_points; ++q)</div><div class="line">      {</div><div class="line">        computed_quantities[q](0)</div><div class="line">          = (inputs.solution_values[q](0)</div><div class="line">             +</div><div class="line">             inputs.solution_values[q](1) * std::fabs(level_set(inputs.evaluation_points[q])));</div><div class="line">        computed_quantities[q](1)</div><div class="line">          = (computed_quantities[q](0)</div><div class="line">             -</div><div class="line">             exact_solution (inputs.evaluation_points[q]));</div><div class="line">      }</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::output_results (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (cycle &lt; 10, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line"></div><div class="line">    std::string filename = <span class="stringliteral">&quot;solution-&quot;</span>;</div><div class="line">    filename += (<span class="charliteral">&#39;0&#39;</span> + cycle);</div><div class="line">    filename += <span class="stringliteral">&quot;.vtk&quot;</span>;</div><div class="line"></div><div class="line">    std::ofstream output (filename.c_str());</div><div class="line"></div><div class="line">    Postprocessor&lt;dim&gt; postprocessor;</div><div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim,hp::DoFHandler&lt;dim&gt;</a> &gt; data_out;</div><div class="line"></div><div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a> (dof_handler);</div><div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a> (solution, <span class="stringliteral">&quot;solution&quot;</span>);</div><div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a> (solution, postprocessor);</div><div class="line">    data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a> (5);</div><div class="line"></div><div class="line">    data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a> (output);</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::compute_error ()<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <a class="code" href="classhp_1_1QCollection.html">hp::QCollection&lt;dim&gt;</a> q_collection;</div><div class="line">    q_collection.<a class="code" href="classhp_1_1QCollection.html#a166f1c95b492e6293215998210caf605">push_back</a> (<a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2));</div><div class="line">    q_collection.<a class="code" href="classhp_1_1QCollection.html#a166f1c95b492e6293215998210caf605">push_back</a> (<a class="code" href="classQIterated.html">QIterated&lt;dim&gt;</a>(<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(2), 4));</div><div class="line"></div><div class="line">    <a class="code" href="classhp_1_1FEValues.html">hp::FEValues&lt;dim&gt;</a> hp_fe_values (fe_collection, q_collection,</div><div class="line">                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa49a49d892021457f921318905c408e25">update_q_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> l2_error_square = 0;</div><div class="line"></div><div class="line">    std::vector&lt;Vector&lt;double&gt; &gt; solution_values;</div><div class="line"></div><div class="line">    <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#gafe703004a41973a6808c81d42ad7e7b1">hp::DoFHandler&lt;dim&gt;::active_cell_iterator</a></div><div class="line">    cell = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>(),</div><div class="line">    endc = dof_handler.<a class="code" href="classDoFHandler.html#a7b510a66ee9ea25720f64220496126ec">end</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (; cell!=endc; ++cell)</div><div class="line">      {</div><div class="line">        hp_fe_values.reinit (cell);</div><div class="line"></div><div class="line">        <span class="keyword">const</span> <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> &amp;fe_values = hp_fe_values.<a class="code" href="classFEValues.html#a4bc26790261f1f9f4cc7e8e69e3d7920">get_present_fe_values</a> ();</div><div class="line"></div><div class="line">        solution_values.resize (fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>,</div><div class="line">                                <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(2));</div><div class="line">        fe_values.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a> (solution,</div><div class="line">                                       solution_values);</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q=0; q&lt;fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++q)</div><div class="line">          {</div><div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> local_error = (solution_values[q](0)</div><div class="line">                                        +</div><div class="line">                                        std::fabs(level_set(fe_values.<a class="code" href="classFEValuesBase.html#ab123e5da03736be4977c76fbcb6a2e37">quadrature_point</a>(q))) *</div><div class="line">                                        solution_values[q](1)</div><div class="line">                                        -</div><div class="line">                                        exact_solution (fe_values.<a class="code" href="classFEValuesBase.html#ab123e5da03736be4977c76fbcb6a2e37">quadrature_point</a>(q)));</div><div class="line">            l2_error_square += local_error * local_error * fe_values.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q);</div><div class="line">          }</div><div class="line">      }</div><div class="line"></div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;   L2 error = &quot;</span> &lt;&lt; std::sqrt (l2_error_square)</div><div class="line">              &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line">  <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::run ()</div><div class="line">  {</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle=0; cycle&lt;6; ++cycle)</div><div class="line">      {</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; cycle &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (cycle == 0)</div><div class="line">          {</div><div class="line">            <a class="code" href="namespaceGridGenerator.html#a0a81f736ef95164a9d9bf0f844ac682b">GridGenerator::hyper_ball</a> (triangulation);</div><div class="line"></div><div class="line">            <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold&lt;dim&gt;</a> boundary;</div><div class="line">            triangulation.<a class="code" href="group__manifold.html#ga1f1ea841946c94c079388ecf9ad2c00c">set_all_manifold_ids_on_boundary</a>(0);</div><div class="line">            triangulation.<a class="code" href="group__manifold.html#ga9f9d720f5fbdcdf3dcbb445feefbdb9f">set_manifold</a> (0, boundary);</div><div class="line"></div><div class="line">            triangulation.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a> (2);</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          triangulation.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a> (1);</div><div class="line"></div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span></div><div class="line">                  &lt;&lt; triangulation.<a class="code" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">n_active_cells</a>()</div><div class="line">                  &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        setup_system ();</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span></div><div class="line">                  &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div><div class="line">                  &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        assemble_system ();</div><div class="line">        solve ();</div><div class="line">        compute_error ();</div><div class="line">        output_results (cycle);</div><div class="line">      }</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line"></div><div class="line">  <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div><div class="line">      <span class="keyword">using namespace </span>Step47;</div><div class="line"></div><div class="line">      LaplaceProblem&lt;2&gt; laplace_problem_2d;</div><div class="line">      laplace_problem_2d.run ();</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line"></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (...)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
