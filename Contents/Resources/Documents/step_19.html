<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-19 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2017 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The step-19 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
      <ul>
        <li><a href="#Preliminaries">Preliminaries</a>
        <li><a href="#Declaringparametersfortheinputfile">Declaring parameters for the input file</a>
        <li><a href="#Parsingthecommandline">Parsing the command line</a>
        <li><a href="#Generatingoutput">Generating output</a>
        <li><a href="#Dispatchingoutputgeneration">Dispatching output generation</a>
        <li><a href="#main">main()</a>
      </ul>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>In <a class="el" href="step_18.html">step-18</a>, we saw a need to write output files in an intermediate format: in a parallel program, it doesn't scale well if all processors participate in computing a result, and then only a single processor generates the graphical output. Rather, each of them should generate output for its share of the domain, and later on merge all these output files into a single one.</p>
<p>Thus was the beginning of <a class="el" href="step_19.html">step-19</a>: it is the program that reads a number of files written in intermediate format, and merges and converts them into the final format that one would like to use for visualization. It can also be used for the following purpose: if you are unsure at the time of a computation what graphics program you would like to use, write your results in intermediate format; it can later be converted, using the present program, to any other format you may want.</p>
<p>While this in itself was not interesting enough to make a tutorial program, we have used the opportunity to introduce one class that has proven to be extremely help- and useful in real application programs, but had not been covered by any of the previous tutorial programs: the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class. This class is used in applications that want to have some of their behavior determined at run time, using input files. For example, one may want to specify the geometry, or specifics of the equation to be solved, at run time. Other typical parameters are the number of nonlinear iterations, the name of output files, or the names of input files specifying material properties or boundary conditions.</p>
<p>Working with such parameter files is not rocket science. However, it is rather tedious to write the parsers for such files, in particular if they should be extensible, be able to group parameters into subsections, perform some error checks such as that parameters can have only certain kinds of values (for example, it should only be allowed to have integer values in an input file for parameters that denote a number of iteration), and similar requirements. The <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class allows for all this: an application program will declare the parameters it expects (or call a function in the library that declares a number of parameters for you), the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class then reads an input file with all these parameters, and the application program can then get their values back from this class.</p>
<p>In order to perform these three steps, the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> offers three sets of functions: first, the <code><a class="el" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">ParameterHandler::declare_entry</a></code> function is used to declare the existence of a named parameter in the present section of the input file (one can enter and leave subsections in a parameter file just like you would navigate through a directory tree in a file system, with the functions <code><a class="el" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">ParameterHandler::enter_subsection</a></code> and <code><a class="el" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">ParameterHandler::leave_subsection</a></code> taking on the roles of the commands <code>cd dir</code> and <code>cd ..</code>; the only difference being that if you enter a subsection that has never been visited before, it is created: it isn't necessary to "create" subsections explicitly). When declaring a parameter, one has to specify its name and default value, in case the parameter isn't later listed explicitly in the parameter file. In addition to that, there are optional arguments indicating a pattern that a parameter has to satisfy, such as being an integer (see the discussion above), and a help text that might later give an explanation of what the parameter stands for.</p>
<p>Once all parameters have been declared, parameters can be read, using the <code><a class="el" href="classParameterHandler.html#a4f067f0a84ac392fe26d553aea50541b">ParameterHandler::parse_input</a></code> family of functions. There are versions of this function that can read from a file stream, that take a file name, or that simply take a string and parse it. When reading parameters, the class makes sure that only parameters are listed in the input that have been declared before, and that the values of parameters satisfy the pattern that has been given to describe the kind of values a parameter can have. Input that uses undeclared parameters or values for parameters that do not conform to the pattern are rejected by raising an exception.</p>
<p>A typical input file will look like this: </p><div class="fragment"><div class="line"><span class="keyword">set</span> Output format  = <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1af54db6e70b60a249b36f803d0657b39e">dx</a></div><div class="line"><span class="keyword">set</span> Output file    = my_output_file.dx</div><div class="line"></div><div class="line"><span class="keyword">set</span> Maximal number of iterations = 13</div><div class="line"></div><div class="line">subsection Application</div><div class="line">  <span class="keyword">set</span> Color of output = blue</div><div class="line">  <span class="keyword">set</span> Generate output = <span class="keyword">false</span></div><div class="line">end</div></div><!-- fragment --><p> Note that subsections can be nested.</p>
<p>Finally, the application program can get the values of declared parameters back by traversing the subsections of the parameter tree and using the <code><a class="el" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">ParameterHandler::get</a></code> and related functions. The <code><a class="el" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">ParameterHandler::get</a></code> simply returns the value of a parameter as a string, whereas <code><a class="el" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">ParameterHandler::get_integer</a></code>, <code><a class="el" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">ParameterHandler::get_double</a></code>, and <code><a class="el" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">ParameterHandler::get_bool</a></code> already convert them to the indicated type.</p>
<p>Using the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class therefore provides for a pretty flexible mechanism to handle all sorts of moderately complex input files without much effort on the side of the application programmer. We will use this to provide all sorts of options to the <a class="el" href="step_19.html">step-19</a> program in order to convert from intermediate file format to any other graphical file format.</p>
<p>The rest of the story is probably best told by looking at the source of <a class="el" href="step_19.html">step-19</a> itself. Let us, however, end this introduction by pointing the reader at the extensive class documentation of the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class for more information on specific details of that class. <a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Preliminaries"></a> </p><h4>Preliminaries</h4>
<p>As usual, we start with include files. This program is content with really few of these &ndash; we only need two files from the library (one for input and output of graphical data, one for parameter handling), and a few C++ standard headers:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;deal.II/base/data_out_base.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/parameter_handler.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div></div><!-- fragment --><p>As mentioned in the first few tutorial programs, all names in deal.II are declared in a namespace <code>dealii</code>. To make using these function and class names simpler, we import the entire content of that namespace into the global scope. As done for all previous programs already, we'll also place everything we do here into a namespace of its own:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>Step19</div><div class="line">{</div><div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div></div><!-- fragment --><p>Before we start with the actual program, let us declare a few global variables that will be used to hold the parameters this program is going to use. Usually, global variables are frowned upon for a good reason, but since we have such a short program here that does only a single thing, we may stray from our usual line and make these variables global, rather than passing them around to all functions or encapsulating them into a class.</p>
<p>The variables we have are: first, an object that will hold parameters of operation, such as output format (unless given on the command line); second, the names of input and output files; and third, the format in which the output is to be written:</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterHandler.html">ParameterHandler</a>         prm;</div><div class="line">std::vector&lt;std::string&gt; input_file_names;</div><div class="line">std::string              output_file;</div><div class="line">std::string              output_format;</div></div><!-- fragment --><p>All the stuff this program does can be done from here on. As described in the introduction, what we have to do is declare what values the parameter file can have, parse the command line, read the input files, then write the output. We will do this in this order of operation, but before that let us declare a function that prints a message about how this program is to be used; the function first prints a general message, and then goes on to list the parameters that are allowed in the parameter file (the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class has a function to do exactly this; see the results section for what it prints):</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span></div><div class="line">print_usage_message ()</div><div class="line">{</div><div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *message</div><div class="line">    =</div><div class="line">      <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;Converter from deal.II intermediate format to other graphics formats.\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;    ./step-19 [-p parameter_file] list_of_input_files \n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;              [-x output_format] [-o output_file]\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;Parameter sequences in brackets can be omitted if a parameter file is\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;specified on the command line and if it provides values for these\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;missing parameters.\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;The parameter file has the following format and allows the following\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;values (you can cut and paste this and use it for your own parameter\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;file):\n&quot;</span></div><div class="line">      <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">  std::cout &lt;&lt; message;</div><div class="line"></div><div class="line">  prm.<a class="code" href="classParameterHandler.html#a5d5f6dff73abcca2b6abca8d8a18afa1">print_parameters</a> (std::cout, <a class="code" href="classParameterHandler.html#a8364dda711b93753c6809eefe2a8e827ae4d13a4598073bfcb69cd0cf4c1f8365">ParameterHandler::Text</a>);</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="Declaringparametersfortheinputfile"></a> </p><h4>Declaring parameters for the input file</h4>
<p>The second function is used to declare the parameters this program accepts from the input file. While we don't actually take many parameters from the input file except for, possibly, the output file name and format, we nevertheless want to show how to work with parameter files.</p>
<p>In short, the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class works as follows: one declares the entries of parameters that can be given in input files together, and later on one can read an input file in which these parameters are set to their values. If a parameter is not listed in the input file, the default value specified in the declaration of that parameter is used. After that, the program can query the values assigned to certain parameters from the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> object.</p>
<p>Declaring parameters can be done using the <code><a class="el" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">ParameterHandler::declare_entry</a></code> function. It's arguments are the name of a parameter, a default value (given as a string, even if the parameter is numeric in nature, and thirdly an object that describes constraints on values that may be passed to this parameter. In the example below, we use an object of type <code><a class="el" href="classPatterns_1_1Anything.html">Patterns::Anything</a></code> to denote that there are no constraints on file names (this is, of course, not true &ndash; the operating system does have constraints, but from an application standpoint, almost all names are valid). In other cases, one may, for example, use <code><a class="el" href="classPatterns_1_1Integer.html">Patterns::Integer</a></code> to make sure that only parameters are accepted that can be interpreted as integer values (it is also possible to specify bounds for integer values, and all values outside this range are rejected), <code><a class="el" href="classPatterns_1_1Double.html">Patterns::Double</a></code> for floating point values, classes that make sure that the given parameter value is a comma separated list of things, etc. Take a look at the <code><a class="el" href="namespacePatterns.html">Patterns</a></code> namespace to see what is possible.</p>
<p>The fourth argument to <code>declare_entry</code> is a help string that can be printed to document what this parameter is meant to be used for and other information you may consider important when declaring this parameter. The default value of this fourth argument is the empty string.</p>
<p>I always wanted to have an example program describing the <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class, because it is so particularly useful. It would have been useful in a number of previous example programs (for example, in order to let the tolerance for linear solvers, or the number of refinement steps be determined by a run-time parameter, rather than hard-coding them into the program), but it turned out that trying to explain this class there would have overloaded them with things that would have distracted from the main purpose. However, while writing this program, I realized that there aren't all that many parameters this program can usefully ask for, or better, it turned out: declaring and querying these parameters was already done centralized in one place of the library, namely the <code><a class="el" href="classDataOutInterface.html">DataOutInterface</a></code> class that handles exactly this &ndash; managing parameters for input and output.</p>
<p>So the second function call in this function is to let the <code><a class="el" href="classDataOutInterface.html">DataOutInterface</a></code> declare a good number of parameters that control everything from the output format to what kind of output should be generated if output is written in a specific graphical format. For example, when writing data in encapsulated postscript (EPS) format, the result is just a 2d projection, not data that can be viewed and rotated with a viewer. Therefore, one has to choose the viewing angle and a number of other options up front, when output is generated, rather than playing around with them later on. The call to <code><a class="el" href="classDataOutInterface.html#a1f2f1d644d9cb1c4d1714d5173d159f2">DataOutInterface::declare_parameters</a></code> declares entries that allow to specify them in the parameter input file during run-time. If the parameter file does not contain entries for them, defaults are taken.</p>
<p>As a final note: <code><a class="el" href="classDataOutInterface.html">DataOutInterface</a></code> is a template, because it is usually used to write output for a specific space dimension. However, this program is supposed to be used for all dimensions at the same time, so we don't know at compile time what the right dimension is when specifying the template parameter. Fortunately, declaring parameters is something that is space dimension independent, so we can just pick one arbitrarily. We pick <code>1</code>, but it could have been any other number as well.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> declare_parameters ()</div><div class="line">{</div><div class="line">  prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Output file&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">                     <a class="code" href="classPatterns_1_1Anything.html">Patterns::Anything</a>(),</div><div class="line">                     <span class="stringliteral">&quot;The name of the output file to be generated&quot;</span>);</div><div class="line"></div><div class="line">  <a class="code" href="classDataOutInterface.html#a1f2f1d644d9cb1c4d1714d5173d159f2">DataOutInterface&lt;1&gt;::declare_parameters</a> (prm);</div></div><!-- fragment --><p>Since everything that this program can usefully request in terms of input parameters is already handled by now, let us nevertheless show how to use input parameters in other circumstances. First, parameters are like files in a directory tree: they can be in the top-level directory, but you can also group them into subdirectories to make it easier to find them or to be able to use the same parameter name in different contexts.</p>
<p>Let us first declare a dummy parameter in the top-level section; we assume that it will denote the number of iterations, and that useful numbers of iterations that a user should be able to specify are in the range 1...1000, with a default value of 42:</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy iterations&quot;</span>, <span class="stringliteral">&quot;42&quot;</span>,</div><div class="line">                   <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a> (1,1000),</div><div class="line">                   <span class="stringliteral">&quot;A dummy parameter asking for an integer&quot;</span>);</div></div><!-- fragment --><p>Next, let us declare a sub-section (the equivalent to a subdirectory). When entered, all following parameter declarations will be within this subsection. To also visually group these declarations with the subsection name, I like to use curly braces to force my editor to indent everything that goes into this sub-section by one level of indentation. In this sub-section, we shall have two entries, one that takes a Boolean parameter and one that takes a selection list of values, separated by the '|' character:</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a> (<span class="stringliteral">&quot;Dummy subsection&quot;</span>);</div><div class="line">{</div><div class="line">  prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy generate output&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>,</div><div class="line">                     <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>(),</div><div class="line">                     <span class="stringliteral">&quot;A dummy parameter that can be fed with either &quot;</span></div><div class="line">                     <span class="stringliteral">&quot;&#39;true&#39; or &#39;false&#39;&quot;</span>);</div><div class="line">  prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy color of output&quot;</span>, <span class="stringliteral">&quot;red&quot;</span>,</div><div class="line">                     <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(<span class="stringliteral">&quot;red|black|blue&quot;</span>),</div><div class="line">                     <span class="stringliteral">&quot;A dummy parameter that shows how one can define a &quot;</span></div><div class="line">                     <span class="stringliteral">&quot;parameter that can be assigned values from a finite &quot;</span></div><div class="line">                     <span class="stringliteral">&quot;set of values&quot;</span>);</div><div class="line">}</div><div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a> ();</div></div><!-- fragment --><p>After this, we have left the subsection again. You should have gotten the idea by now how one can nest subsections to separate parameters. There are a number of other possible patterns describing possible values of parameters; in all cases, if you try to pass a parameter to the program that does not match the expectations of the pattern, it will reject the parameter file and ask you to fix it. After all, it does not make much sense if you had an entry that contained the entry "red" for the parameter "Generate output".</p>
<div class="fragment"><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="Parsingthecommandline"></a> </p><h4>Parsing the command line</h4>
<p>Our next task is to see what information has been provided on the command line. First, we need to be sure that there is at least one parameter: an input file. The format and the output file can be specified in the parameter file, but the list of input files can't, so at least one parameter needs to be there. Together with the name of the program (the zeroth parameter), <code>argc</code> must therefore be at least 2. If this is not the case, we print an error message and exit:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span></div><div class="line">parse_command_line (<span class="keyword">const</span> <span class="keywordtype">int</span>     argc,</div><div class="line">                    <span class="keywordtype">char</span> *<span class="keyword">const</span> *argv)</div><div class="line">{</div><div class="line">  <span class="keywordflow">if</span> (argc &lt; 2)</div><div class="line">    {</div><div class="line">      print_usage_message ();</div><div class="line">      exit (1);</div><div class="line">    }</div></div><!-- fragment --><p>Next, collect all parameters in a list that will be somewhat simpler to handle than the <code>argc</code>/<code>argv</code> mechanism. We omit the name of the executable at the zeroth index:</p>
<div class="fragment"><div class="line">std::list&lt;std::string&gt; args;</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;argc; ++i)</div><div class="line">  args.push_back (argv[i]);</div></div><!-- fragment --><p>Then process all these parameters. If the parameter is <code>-p</code>, then there must be a parameter file following (which we should then read), in case of <code>-x</code> it is the name of an output format. Finally, for <code>-o</code> it is the name of the output file. In all cases, once we've treated a parameter, we remove it from the list of parameters:</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (args.size())</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-p&quot;</span>))</div><div class="line">      {</div><div class="line">        <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">          {</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-p&#39; must be followed by the &quot;</span></div><div class="line">                      &lt;&lt; <span class="stringliteral">&quot;name of a parameter file.&quot;</span></div><div class="line">                      &lt;&lt; std::endl;</div><div class="line">            print_usage_message ();</div><div class="line">            exit (1);</div><div class="line">          }</div><div class="line">        args.pop_front ();</div><div class="line">        <span class="keyword">const</span> std::string parameter_file = args.front ();</div><div class="line">        args.pop_front ();</div></div><!-- fragment --><p>Now read the input file :</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#a4f067f0a84ac392fe26d553aea50541b">parse_input</a> (parameter_file);</div></div><!-- fragment --><p>Both the output file name as well as the format can be specified on the command line. We have therefore given them global variables that hold their values, but they can also be set in the parameter file. We therefore need to extract them from the parameter file here, because they may be overridden by later command line parameters:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (output_file == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">  output_file = prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a> (<span class="stringliteral">&quot;Output file&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (output_format == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">  output_format = prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a> (<span class="stringliteral">&quot;Output format&quot;</span>);</div></div><!-- fragment --><p>Finally, let us note that if we were interested in the values of the parameters declared above in the dummy subsection, we would write something like this to extract the value of the Boolean flag (the <code>prm.get</code> function returns the value of a parameter as a string, whereas the <code>prm.get_X</code> functions return a value already converted to a different type):</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a> (<span class="stringliteral">&quot;Dummy subsection&quot;</span>);</div><div class="line">{</div><div class="line">  prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a> (<span class="stringliteral">&quot;Dummy generate output&quot;</span>);</div><div class="line">}</div><div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a> ();</div></div><!-- fragment --><p>We would assign the result to a variable, of course, but don't here in order not to generate an unused variable that the compiler might warn about.</p>
<p>Alas, let's move on to handling of output formats:</p>
<div class="fragment"><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-x&quot;</span>))</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">      {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-x&#39; must be followed by the &quot;</span></div><div class="line">                  &lt;&lt; <span class="stringliteral">&quot;name of an output format.&quot;</span></div><div class="line">                  &lt;&lt; std::endl;</div><div class="line">        print_usage_message ();</div><div class="line">        exit (1);</div><div class="line">      }</div><div class="line">    args.pop_front ();</div><div class="line">    output_format = args.front();</div><div class="line">    args.pop_front ();</div><div class="line">  }</div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-o&quot;</span>))</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">      {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-o&#39; must be followed by the &quot;</span></div><div class="line">                  &lt;&lt; <span class="stringliteral">&quot;name of an output file.&quot;</span></div><div class="line">                  &lt;&lt; std::endl;</div><div class="line">        print_usage_message ();</div><div class="line">        exit (1);</div><div class="line">      }</div><div class="line">    args.pop_front ();</div><div class="line">    output_file = args.front();</div><div class="line">    args.pop_front ();</div><div class="line">  }</div></div><!-- fragment --><p>Otherwise, this is not a parameter that starts with a known minus sequence, and we should consider it to be the name of an input file. Let us therefore add this file to the list of input files:</p>
<div class="fragment"><div class="line">  <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">      input_file_names.push_back (args.front());</div><div class="line">      args.pop_front ();</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>Next check a few things and create errors if the checks fail. Firstly, there must be at least one input file</p>
<div class="fragment"><div class="line">  <span class="keywordflow">if</span> (input_file_names.size() == 0)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: No input file specified.&quot;</span> &lt;&lt; std::endl;</div><div class="line">      print_usage_message ();</div><div class="line">      exit (1);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="Generatingoutput"></a> </p><h4>Generating output</h4>
<p>Now that we have all the information, we need to read all the input files, merge them, and generate a single output file. This, after all, was the motivation, borne from the necessity encountered in the <a class="el" href="step_18.html">step-18</a> tutorial program, to write this program in the first place.</p>
<p>So what we do first is to declare an object into which we will merge the data from all the input file, and read in the first file through a stream. Note that every time we open a file, we use the <code>AssertThrow</code> macro to check whether the file is really readable &ndash; if it isn't then this will trigger an exception and corresponding output will be generated from the exception handler in <code>main()</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div><div class="line"><span class="keywordtype">void</span> do_convert ()</div><div class="line">{</div><div class="line">  <a class="code" href="classDataOutReader.html">DataOutReader&lt;dim,spacedim&gt;</a> merged_data;</div><div class="line"></div><div class="line">  {</div><div class="line">    std::ifstream input (input_file_names[0].c_str());</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">    merged_data.<a class="code" href="classDataOutReader.html#a904bedb71f83c6f9eb11a17df2b9e05c">read</a> (input);</div><div class="line">  }</div></div><!-- fragment --><p>For all the other input files, we read their data into an intermediate object, and then merge that into the first object declared above:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=1; i&lt;input_file_names.size(); ++i)</div><div class="line">  {</div><div class="line">    std::ifstream input (input_file_names[i].c_str());</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">    <a class="code" href="classDataOutReader.html">DataOutReader&lt;dim,spacedim&gt;</a> additional_data;</div><div class="line">    additional_data.<a class="code" href="classDataOutReader.html#a904bedb71f83c6f9eb11a17df2b9e05c">read</a> (input);</div><div class="line">    merged_data.<a class="code" href="classDataOutReader.html#a2eff9f62f603ce196fc4681fcd5535dc">merge</a> (additional_data);</div><div class="line">  }</div></div><!-- fragment --><p>Once we have this, let us open an output stream, and parse what we got as the name of the output format into an identifier. Fortunately, the <code><a class="el" href="namespaceDataOutBase.html">DataOutBase</a></code> class has a function that does this parsing for us, i.e. it knows about all the presently supported output formats and makes sure that they can be specified in the parameter file or on the command line. Note that this ensures that if the library acquires the ability to output in other output formats, this program will be able to make use of this ability without having to be changed!</p>
<div class="fragment"><div class="line">std::ofstream output_stream (output_file.c_str());</div><div class="line"><a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (output_stream, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line"><span class="keyword">const</span> <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1">DataOutBase::OutputFormat</a> format</div><div class="line">  = <a class="code" href="namespaceDataOutBase.html#abbf6308a89986d2081638ef3117699a9">DataOutBase::parse_output_format</a> (output_format);</div></div><!-- fragment --><p>Finally, write the merged data to the output:</p>
<div class="fragment"><div class="line">  merged_data.<a class="code" href="classDataOutInterface.html#a78e73ad285a8792ff0f9f227b82eb108">write</a>(output_stream, format);</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="Dispatchingoutputgeneration"></a> </p><h4>Dispatching output generation</h4>
<p>The function above takes template parameters relating to the space dimension of the output, and the dimension of the objects to be output. (For example, when outputting whole cells, these two dimensions are the same, but the intermediate files may contain only data pertaining to the faces of cells, in which case the first parameter will be one less than the space dimension.)</p>
<p>The problem is: at compile time, we of course don't know the dimensions used in the input files. We have to plan for all cases, therefore. This is a little clumsy, since we need to specify the dimensions statically at compile time, even though we will only know about them at run time.</p>
<p>So here is what we do: from the first input file, we determine (using a function in <code><a class="el" href="namespaceDataOutBase.html">DataOutBase</a></code> that exists for this purpose) these dimensions. We then have a series of switches that dispatch, statically, to the <code>do_convert</code> functions with different template arguments. Not pretty, but works. Apart from this, the function does nothing &ndash; except making sure that it covered the dimensions for which it was called, using the <code>AssertThrow</code> macro at places in the code that shouldn't be reached:</p>
<div class="fragment"><div class="line">  <span class="keywordtype">void</span> convert ()</div><div class="line">  {</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input_file_names.size() &gt; 0,</div><div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a> (<span class="stringliteral">&quot;No input files specified.&quot;</span>));</div><div class="line"></div><div class="line">    std::ifstream input(input_file_names[0].c_str());</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt;</div><div class="line">    dimensions = <a class="code" href="namespaceDataOutBase.html#a14e601aef19bd7d10884a1d25f07f3f8">DataOutBase::determine_intermediate_format_dimensions</a> (input);</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (dimensions.first)</div><div class="line">      {</div><div class="line">      <span class="keywordflow">case</span> 1:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 1:</div><div class="line">            do_convert &lt;1,1&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">          <span class="keywordflow">case</span> 2:</div><div class="line">            do_convert &lt;1,2&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="keywordflow">case</span> 2:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 2:</div><div class="line">            do_convert &lt;2,2&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">          <span class="keywordflow">case</span> 3:</div><div class="line">            do_convert &lt;2,3&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="keywordflow">case</span> 3:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 3:</div><div class="line">            do_convert &lt;3,3&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">      }</div><div class="line"></div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="main"></a> </p><h4>main()</h4>
<p>Finally, the main program. There is not much more to do than to make sure parameters are declared, the command line is parsed (which includes reading parameter files), and finally making sure the input files are read and output is generated. Everything else just has to do with handling exceptions and making sure that appropriate output is generated if one is thrown.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">      <span class="keyword">using namespace </span>Step19;</div><div class="line"></div><div class="line">      declare_parameters ();</div><div class="line">      parse_command_line (argc, argv);</div><div class="line"></div><div class="line">      convert ();</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line"></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (...)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    };</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>With all that above, here is first what we get if we just run the program without any parameters at all: </p><div class="fragment"><div class="line">examples/step-19&gt; ./step-19</div><div class="line"></div><div class="line">Converter from deal.II intermediate format to other graphics formats.</div><div class="line"></div><div class="line">Usage:</div><div class="line">    ./step-19 [-p parameter_file] list_of_input_files</div><div class="line">              [-x output_format] [-o output_file]</div><div class="line"></div><div class="line">Parameter sequences in brackets can be omitted <span class="keywordflow">if</span> a parameter file is</div><div class="line">specified on the command line and <span class="keywordflow">if</span> it provides values <span class="keywordflow">for</span> these</div><div class="line">missing parameters.</div><div class="line"></div><div class="line">The parameter file has the following format and allows the following</div><div class="line">values (you can cut and paste <span class="keyword">this</span> and use it <span class="keywordflow">for</span> your own parameter</div><div class="line">file):</div><div class="line"></div><div class="line"># Listing of Parameters</div><div class="line"># ---------------------</div><div class="line"># A dummy parameter asking for an integer</div><div class="line">set Dummy iterations = 42</div><div class="line"></div><div class="line"># The name of the output file to be generated</div><div class="line">set Output file      =</div><div class="line"></div><div class="line"># A name for the output format to be used</div><div class="line">set Output format    = <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a></div><div class="line"></div><div class="line"></div><div class="line">subsection DX output parameters</div><div class="line">  # A Boolean field indicating whether neighborship information between cells</div><div class="line">  # is to be written to the OpenDX output file</div><div class="line">  set Write neighbors = true</div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">subsection Dummy subsection</div><div class="line">  # A dummy parameter that shows how one can define a parameter that can be</div><div class="line">  # assigned values from a finite set of values</div><div class="line">  set Dummy color of output = red</div><div class="line"></div><div class="line">  # A dummy parameter that can be fed with either <span class="stringliteral">&#39;true&#39;</span> or <span class="stringliteral">&#39;false&#39;</span></div><div class="line">  set Dummy generate output = true</div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">subsection Eps output parameters</div><div class="line">  # Angle of the viewing position against the vertical axis</div><div class="line">  set Azimut angle                        = 60</div><div class="line"></div><div class="line">  # Name of a color function used to colorize mesh lines and/or cell</div><div class="line">  # interiors</div><div class="line">  set Color function                      = default</div><div class="line"></div><div class="line">  # Whether the interior of cells shall be shaded</div><div class="line">  set Color shading of interior of cells  = true</div><div class="line"></div><div class="line">  # Whether the mesh lines, or only the surface should be drawn</div><div class="line">  set Draw mesh lines                     = true</div><div class="line"></div><div class="line">  # Whether only the mesh lines, or also the interior of cells should be</div><div class="line">  # plotted. If this flag is false, then one can see through the mesh</div><div class="line">  set Fill interior of cells              = true</div><div class="line"></div><div class="line">  # Number of the input vector that is to be used to generate color</div><div class="line">  # information</div><div class="line">  set Index of vector for color           = 0</div><div class="line"></div><div class="line">  # Number of the input vector that is to be used to generate height</div><div class="line">  # information</div><div class="line">  set Index of vector for height          = 0</div><div class="line"></div><div class="line">  # The width in which the postscript renderer is to plot lines</div><div class="line">  set Line widths in <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1acf35b7afd6a85044d32320355fbaabfe">eps</a> units            = 0.5</div><div class="line"></div><div class="line">  # Whether width or height should be scaled to match the given size</div><div class="line">  set Scale to width or height            = width</div><div class="line"></div><div class="line">  # Scaling for the z-direction relative to the scaling used in x- and</div><div class="line">  # y-directions</div><div class="line">  set Scaling for z-axis                  = 1</div><div class="line"></div><div class="line">  # The size (width or height) to which the <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1acf35b7afd6a85044d32320355fbaabfe">eps</a> output file is to be scaled</div><div class="line">  set Size (width or height) in <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1acf35b7afd6a85044d32320355fbaabfe">eps</a> units = 300</div><div class="line"></div><div class="line">  # Angle of the viewing direction against the y-axis</div><div class="line">  set Turn angle                          = 30</div><div class="line">end</div><div class="line"></div><div class="line">subsection Povray output parameters</div><div class="line">  # Whether camera and lighting information should be put into an external</div><div class="line">  # file <span class="stringliteral">&quot;data.inc&quot;</span> or into the POVRAY input file</div><div class="line">  set Include external file = true</div><div class="line"></div><div class="line">  # Whether POVRAY should use bicubic patches</div><div class="line">  set Use bicubic patches   = false</div><div class="line"></div><div class="line">  # A flag indicating whether POVRAY should use smoothed triangles instead of</div><div class="line">  # the usual ones</div><div class="line">  set Use smooth triangles  = false</div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">subsection UCD output parameters</div><div class="line">  # A flag indicating whether a comment should be written to the beginning of</div><div class="line">  # the output file indicating date and time of creation as well as the</div><div class="line">  # creating program</div><div class="line">  set Write preamble = true</div><div class="line">end</div></div><!-- fragment --><p>That's a lot of output for such a little program, but then that's also a lot of output formats that deal.II supports. You will realize that the output consists of first entries in the top-level section (sorted alphabetically), then a sorted list of subsections. Most of the parameters have been declared by the <code><a class="el" href="namespaceDataOutBase.html">DataOutBase</a></code> class, but there are also the dummy entries and sections we have added in the <code>declare_parameters()</code> function, along with their default values and documentations.</p>
<p>Let us try to run this program on a set of input files generated by a modified <a class="el" href="step_18.html">step-18</a> run on 32 nodes of a cluster. The computation was rather big, with more than 350,000 cells and some 1.2M unknowns. That makes for 32 rather big intermediate files that we will try to merge using the present program. Here is the list of files, totaling some 245MB of data: </p><div class="fragment"><div class="line">examples/step-19&gt; ls -<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> *d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7982085 Aug 12 10:11 solution-0005.0000-000.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7888316 Aug 12 10:13 solution-0005.0000-001.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7715984 Aug 12 10:09 solution-0005.0000-002.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7887648 Aug 12 10:06 solution-0005.0000-003.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7833291 Aug 12 10:09 solution-0005.0000-004.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7536394 Aug 12 10:07 solution-0005.0000-005.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7817551 Aug 12 10:06 solution-0005.0000-006.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7996660 Aug 12 10:07 solution-0005.0000-007.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7761545 Aug 12 10:06 solution-0005.0000-008.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7754027 Aug 12 10:07 solution-0005.0000-009.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7607545 Aug 12 10:11 solution-0005.0000-010.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7728039 Aug 12 10:07 solution-0005.0000-011.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7577293 Aug 12 10:14 solution-0005.0000-012.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7735626 Aug 12 10:10 solution-0005.0000-013.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7629075 Aug 12 10:10 solution-0005.0000-014.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7314459 Aug 12 10:09 solution-0005.0000-015.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7414738 Aug 12 10:10 solution-0005.0000-016.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7330518 Aug 12 10:05 solution-0005.0000-017.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7418213 Aug 12 10:11 solution-0005.0000-018.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7508715 Aug 12 10:08 solution-0005.0000-019.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7747143 Aug 12 10:06 solution-0005.0000-020.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7563548 Aug 12 10:05 solution-0005.0000-021.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7846767 Aug 12 10:12 solution-0005.0000-022.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7479576 Aug 12 10:12 solution-0005.0000-023.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7925060 Aug 12 10:12 solution-0005.0000-024.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7842034 Aug 12 10:13 solution-0005.0000-025.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7585448 Aug 12 10:13 solution-0005.0000-026.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7609698 Aug 12 10:10 solution-0005.0000-027.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7576053 Aug 12 10:08 solution-0005.0000-028.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7682418 Aug 12 10:08 solution-0005.0000-029.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7544141 Aug 12 10:05 solution-0005.0000-030.d2</div><div class="line">-rw-r--r--  1 bangerth wheeler 7348899 Aug 12 10:04 solution-0005.0000-031.d2</div></div><!-- fragment --><p>So let's see what happens if we attempt to merge all these files into a single one: </p><div class="fragment"><div class="line">examples/step-19&gt; time ./step-19 solution-0005.0000-*.d2 -x <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1a958eea3b2724c76d1c1ff20d69f7da4e">gmv</a> -o solution-0005.gmv</div><div class="line">real    2m08.35s</div><div class="line">user    1m26.61s</div><div class="line">system  0m05.74s</div><div class="line"></div><div class="line">examples/step-19&gt; ls -<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> solution-0005.gmv</div><div class="line">-rw-r--r--  1 bangerth wheeler 240680494 Sep  9 11:53 solution-0005.gmv</div></div><!-- fragment --><p> So in roughly two minutes we have merged 240MB of data. Counting reading and writing, that averages a throughput of 3.8MB per second, not so bad.</p>
<p>If visualized, the output looks very much like that shown for <a class="el" href="step_18.html">step-18</a>. But that's not quite as important for the moment, rather we are interested in showing how to use the parameter file. To this end, remember that if no parameter file is given, or if it is empty, all the default values listed above are used. However, whatever we specify in the parameter file is used, unless overridden again by parameters found later on the command line.</p>
<p>For example, let us use a simple parameter file named <code>solution-0005.prm</code> that contains only one line: </p><div class="fragment"><div class="line"><span class="keyword">set</span> Output format  = <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a></div></div><!-- fragment --><p> If we run <a class="el" href="step_19.html">step-19</a> with it again, we obtain this (for simplicity, and because we don't want to visualize 240MB of data anyway, we only convert the one, the twelfth, intermediate file to gnuplot format): </p><div class="fragment"><div class="line">examples/step-19&gt; ./step-19 solution-0005.0000-012.d2 -p solution-0005.prm -o solution-0005.gnuplot</div><div class="line"></div><div class="line">examples/step-19&gt; ls -<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> solution-0005.gnuplot</div><div class="line">-rw-r--r--  1 bangerth wheeler 20281669 Sep  9 12:15 solution-0005.gnuplot</div></div><!-- fragment --><p>We can then visualize this one file with gnuplot, obtaining something like this: </p><div class="image">
<img src="https://www.dealii.org/images/steps/developer/step-19.solution-0005.png"/>
</div>
<p>That's not particularly exciting, but the file we're looking at has only one 32nd of the entire domain anyway, so we can't expect much.</p>
<p>In more complicated situations, we would use parameter files that set more of the values to non-default values. A file for which this is the case could look like this, generating output for the OpenDX visualization program: </p><div class="fragment"><div class="line"><span class="keyword">set</span> Output format  = <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1af54db6e70b60a249b36f803d0657b39e">dx</a></div><div class="line"><span class="keyword">set</span> Output file    = my_output_file.dx</div><div class="line"></div><div class="line"><span class="keyword">set</span> Dummy iterations = -13</div><div class="line"></div><div class="line">subsection Dummy subsection</div><div class="line">  <span class="keyword">set</span> Dummy color of output = blue</div><div class="line">  <span class="keyword">set</span> Dummy generate output = <span class="keyword">false</span></div><div class="line">end</div></div><!-- fragment --><p> If one wanted to, one could write comments into the file using the same format as used above in the help text, i.e. everything on a line following a hashmark (<code>#</code>) is considered a comment.</p>
<p>If one runs <a class="el" href="step_19.html">step-19</a> with this input file, this is what is going to happen: </p><div class="fragment"><div class="line">examples/step-19&gt; ./step-19 solution-0005.0000-012.d2 -p solution-0005.prm</div><div class="line">Line 4:</div><div class="line">    The entry value</div><div class="line">        -13</div><div class="line">    <span class="keywordflow">for</span> the entry named</div><div class="line">        Dummy iterations</div><div class="line">    does not match the given pattern</div><div class="line">        [Integer range 1...1000 (inclusive)]</div></div><!-- fragment --><p> Ah, right: valid values for the iteration parameter needed to be within the range [1...1000]. We would fix that, then go back to run the program with correct parameters.</p>
<p>This program should have given some insight into the input parameter file handling that deal.II provides. The <code><a class="el" href="classParameterHandler.html">ParameterHandler</a></code> class has a few more goodies beyond what has been shown in this program, for those who want to use this class, it would be useful to read the documentation of that class to get the full picture.</p>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Copyright (C) 2005 - 2016 by the deal.II authors</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div><div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div><div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE at</span></div><div class="line"><span class="comment"> * the top level of the deal.II distribution.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Author: Luca Heltai, Wolfgang Bangerth, 2005</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/data_out_base.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;deal.II/base/parameter_handler.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span>Step19</div><div class="line">{</div><div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div><div class="line"></div><div class="line">  <a class="code" href="classParameterHandler.html">ParameterHandler</a>         prm;</div><div class="line">  std::vector&lt;std::string&gt; input_file_names;</div><div class="line">  std::string              output_file;</div><div class="line">  std::string              output_format;</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span></div><div class="line">  print_usage_message ()</div><div class="line">  {</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *message</div><div class="line">      =</div><div class="line">        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;Converter from deal.II intermediate format to other graphics formats.\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    ./step-19 [-p parameter_file] list_of_input_files \n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;              [-x output_format] [-o output_file]\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;Parameter sequences in brackets can be omitted if a parameter file is\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;specified on the command line and if it provides values for these\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;missing parameters.\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;The parameter file has the following format and allows the following\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;values (you can cut and paste this and use it for your own parameter\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;file):\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    std::cout &lt;&lt; message;</div><div class="line"></div><div class="line">    prm.<a class="code" href="classParameterHandler.html#a5d5f6dff73abcca2b6abca8d8a18afa1">print_parameters</a> (std::cout, <a class="code" href="classParameterHandler.html#a8364dda711b93753c6809eefe2a8e827ae4d13a4598073bfcb69cd0cf4c1f8365">ParameterHandler::Text</a>);</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> declare_parameters ()</div><div class="line">  {</div><div class="line">    prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Output file&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">                       <a class="code" href="classPatterns_1_1Anything.html">Patterns::Anything</a>(),</div><div class="line">                       <span class="stringliteral">&quot;The name of the output file to be generated&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="classDataOutInterface.html#a1f2f1d644d9cb1c4d1714d5173d159f2">DataOutInterface&lt;1&gt;::declare_parameters</a> (prm);</div><div class="line"></div><div class="line">    prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy iterations&quot;</span>, <span class="stringliteral">&quot;42&quot;</span>,</div><div class="line">                       <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a> (1,1000),</div><div class="line">                       <span class="stringliteral">&quot;A dummy parameter asking for an integer&quot;</span>);</div><div class="line"></div><div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a> (<span class="stringliteral">&quot;Dummy subsection&quot;</span>);</div><div class="line">    {</div><div class="line">      prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy generate output&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>,</div><div class="line">                         <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>(),</div><div class="line">                         <span class="stringliteral">&quot;A dummy parameter that can be fed with either &quot;</span></div><div class="line">                         <span class="stringliteral">&quot;&#39;true&#39; or &#39;false&#39;&quot;</span>);</div><div class="line">      prm.<a class="code" href="classParameterHandler.html#afb951f101e0969416f7f47d24c03bcfa">declare_entry</a> (<span class="stringliteral">&quot;Dummy color of output&quot;</span>, <span class="stringliteral">&quot;red&quot;</span>,</div><div class="line">                         <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(<span class="stringliteral">&quot;red|black|blue&quot;</span>),</div><div class="line">                         <span class="stringliteral">&quot;A dummy parameter that shows how one can define a &quot;</span></div><div class="line">                         <span class="stringliteral">&quot;parameter that can be assigned values from a finite &quot;</span></div><div class="line">                         <span class="stringliteral">&quot;set of values&quot;</span>);</div><div class="line">    }</div><div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a> ();</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span></div><div class="line">  parse_command_line (<span class="keyword">const</span> <span class="keywordtype">int</span>     argc,</div><div class="line">                      <span class="keywordtype">char</span> *<span class="keyword">const</span> *argv)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> (argc &lt; 2)</div><div class="line">      {</div><div class="line">        print_usage_message ();</div><div class="line">        exit (1);</div><div class="line">      }</div><div class="line"></div><div class="line">    std::list&lt;std::string&gt; args;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;argc; ++i)</div><div class="line">      args.push_back (argv[i]);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (args.size())</div><div class="line">      {</div><div class="line">        <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-p&quot;</span>))</div><div class="line">          {</div><div class="line">            <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">              {</div><div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-p&#39; must be followed by the &quot;</span></div><div class="line">                          &lt;&lt; <span class="stringliteral">&quot;name of a parameter file.&quot;</span></div><div class="line">                          &lt;&lt; std::endl;</div><div class="line">                print_usage_message ();</div><div class="line">                exit (1);</div><div class="line">              }</div><div class="line">            args.pop_front ();</div><div class="line">            <span class="keyword">const</span> std::string parameter_file = args.front ();</div><div class="line">            args.pop_front ();</div><div class="line"></div><div class="line">            prm.<a class="code" href="classParameterHandler.html#a4f067f0a84ac392fe26d553aea50541b">parse_input</a> (parameter_file);</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (output_file == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">              output_file = prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a> (<span class="stringliteral">&quot;Output file&quot;</span>);</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (output_format == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">              output_format = prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a> (<span class="stringliteral">&quot;Output format&quot;</span>);</div><div class="line"></div><div class="line">            prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a> (<span class="stringliteral">&quot;Dummy subsection&quot;</span>);</div><div class="line">            {</div><div class="line">              prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a> (<span class="stringliteral">&quot;Dummy generate output&quot;</span>);</div><div class="line">            }</div><div class="line">            prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a> ();</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-x&quot;</span>))</div><div class="line">          {</div><div class="line">            <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">              {</div><div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-x&#39; must be followed by the &quot;</span></div><div class="line">                          &lt;&lt; <span class="stringliteral">&quot;name of an output format.&quot;</span></div><div class="line">                          &lt;&lt; std::endl;</div><div class="line">                print_usage_message ();</div><div class="line">                exit (1);</div><div class="line">              }</div><div class="line">            args.pop_front ();</div><div class="line">            output_format = args.front();</div><div class="line">            args.pop_front ();</div><div class="line">          }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (args.front() == std::string(<span class="stringliteral">&quot;-o&quot;</span>))</div><div class="line">          {</div><div class="line">            <span class="keywordflow">if</span> (args.size() == 1)</div><div class="line">              {</div><div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: flag &#39;-o&#39; must be followed by the &quot;</span></div><div class="line">                          &lt;&lt; <span class="stringliteral">&quot;name of an output file.&quot;</span></div><div class="line">                          &lt;&lt; std::endl;</div><div class="line">                print_usage_message ();</div><div class="line">                exit (1);</div><div class="line">              }</div><div class="line">            args.pop_front ();</div><div class="line">            output_file = args.front();</div><div class="line">            args.pop_front ();</div><div class="line">          }</div><div class="line"></div><div class="line">        <span class="keywordflow">else</span></div><div class="line">          {</div><div class="line">            input_file_names.push_back (args.front());</div><div class="line">            args.pop_front ();</div><div class="line">          }</div><div class="line">      }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (input_file_names.size() == 0)</div><div class="line">      {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: No input file specified.&quot;</span> &lt;&lt; std::endl;</div><div class="line">        print_usage_message ();</div><div class="line">        exit (1);</div><div class="line">      }</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div><div class="line">  <span class="keywordtype">void</span> do_convert ()</div><div class="line">  {</div><div class="line">    <a class="code" href="classDataOutReader.html">DataOutReader&lt;dim,spacedim&gt;</a> merged_data;</div><div class="line"></div><div class="line">    {</div><div class="line">      std::ifstream input (input_file_names[0].c_str());</div><div class="line">      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">      merged_data.<a class="code" href="classDataOutReader.html#a904bedb71f83c6f9eb11a17df2b9e05c">read</a> (input);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=1; i&lt;input_file_names.size(); ++i)</div><div class="line">      {</div><div class="line">        std::ifstream input (input_file_names[i].c_str());</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">        <a class="code" href="classDataOutReader.html">DataOutReader&lt;dim,spacedim&gt;</a> additional_data;</div><div class="line">        additional_data.<a class="code" href="classDataOutReader.html#a904bedb71f83c6f9eb11a17df2b9e05c">read</a> (input);</div><div class="line">        merged_data.<a class="code" href="classDataOutReader.html#a2eff9f62f603ce196fc4681fcd5535dc">merge</a> (additional_data);</div><div class="line">      }</div><div class="line"></div><div class="line">    std::ofstream output_stream (output_file.c_str());</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (output_stream, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1">DataOutBase::OutputFormat</a> format</div><div class="line">      = <a class="code" href="namespaceDataOutBase.html#abbf6308a89986d2081638ef3117699a9">DataOutBase::parse_output_format</a> (output_format);</div><div class="line"></div><div class="line">    merged_data.<a class="code" href="classDataOutInterface.html#a78e73ad285a8792ff0f9f227b82eb108">write</a>(output_stream, format);</div><div class="line">  }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> convert ()</div><div class="line">  {</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input_file_names.size() &gt; 0,</div><div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a> (<span class="stringliteral">&quot;No input files specified.&quot;</span>));</div><div class="line"></div><div class="line">    std::ifstream input(input_file_names[0].c_str());</div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (input, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div><div class="line"></div><div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt;</div><div class="line">    dimensions = <a class="code" href="namespaceDataOutBase.html#a14e601aef19bd7d10884a1d25f07f3f8">DataOutBase::determine_intermediate_format_dimensions</a> (input);</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (dimensions.first)</div><div class="line">      {</div><div class="line">      <span class="keywordflow">case</span> 1:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 1:</div><div class="line">            do_convert &lt;1,1&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">          <span class="keywordflow">case</span> 2:</div><div class="line">            do_convert &lt;1,2&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="keywordflow">case</span> 2:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 2:</div><div class="line">            do_convert &lt;2,2&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">          <span class="keywordflow">case</span> 3:</div><div class="line">            do_convert &lt;2,3&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="keywordflow">case</span> 3:</div><div class="line">        <span class="keywordflow">switch</span> (dimensions.second)</div><div class="line">          {</div><div class="line">          <span class="keywordflow">case</span> 3:</div><div class="line">            do_convert &lt;3,3&gt; ();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">          }</div><div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">      }</div><div class="line"></div><div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">      <span class="keyword">using namespace </span>Step19;</div><div class="line"></div><div class="line">      declare_parameters ();</div><div class="line">      parse_command_line (argc, argv);</div><div class="line"></div><div class="line">      convert ();</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line"></div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line">  <span class="keywordflow">catch</span> (...)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line">                &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    };</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
